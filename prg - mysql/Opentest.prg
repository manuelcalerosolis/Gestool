#include "set.ch"
#include "ads.ch"

Field First, Last, Zip

Function Main()

cls

RddSetDefault( "ADS" )
//AdsSetServerType( ADS_REMOTE_SERVER )
AdsSetServerType( ADS_LOCAL_SERVER )
? "[x]Harbour version", Version()
? "Server Type", AdsIsServerLoaded( "C:" )
? "AutoOpen before", Set( _SET_AUTOPEN )
? "AutoOrder before", Set( _SET_AUTORDER )
AdsSetFileType( ADS_CDX )

If ! File( "customer.cdx" )
   Use Customer Alias Cust New Exclusive
   Index On First - Last Tag FirstLast
   Index On Zip Tag Zip
   Use
Endif

Set( _SET_AUTOPEN, .T. )
Set( _SET_AUTORDER, 1 )

Use Customer Alias Cust New Shared
?
? "RDD", RddName()
? "Current TAG", OrdSetFocus()
? "AutoOpen after", Set( _SET_AUTOPEN )
? "AutoOrder after", Set( _SET_AUTORDER )
Use

Return nil