#line 112 "hbclass.ch"
   DYNAMIC DivertConstructorCall
















DECLARE HBClass  New( cName AS String, OPTIONAL SuperParams ) AS CLASS HBClass  Create() AS Object  Instance() AS Object  AddClsMethod( cName AS String, @MethodName(), nScope AS Numeric, n2 AS Numeric, n3 AS Numeric )  AddDelegate( cName AS String, cDelegate AS String, cObject AS String, nScope AS Numeric, lPersistent AS LOGICAL )  AddMultiClsData( cType AS String, uVal, nScope AS Numeric, aDatas AS Array OF String )  AddMultiData( cType AS String, uVal, nScope AS Numeric, aDatas AS Array OF String, x AS LOGICAL, lPer AS LOGICAL )  AddMethod( cName AS String, @MethodName(), nScope AS Numeric, lPersistent AS LOGICAL )  AddInLine( cName AS String, bBlock AS CodeBlock, nScope AS Numeric, lPersistent AS LOGICAL )  AddVirtual( cName AS String )  ModMethod( cName AS String, @MethodName(), nScope AS Numeric, lPersistent AS LOGICAL )  ModClsMethod( cName AS String, @MethodName(), nScope AS Numeric )  ModInline( cName AS String, bBlock AS CodeBlock, nScope AS Numeric, lPersistent AS LOGICAL )  SetOnError( @MethodName() )
#line 85 "\Fwh1204\Include\FiveWin.Ch"
   EXTERNAL GetProcAdd
   EXTERNAL TActiveX




extern errorsys
#line 219 "\Fwh1204\Include\Xbrowse.ch"
   EXTERNAL ADSKEYCOUNT, ADSGETRELKEYPOS, ADSSETRELKEYPOS
#line 9 ".\Prg\TDataCenter.prg"
_HB_CLASS TDataCenter ; UTILITY FUNCTION TDataCenter(...); static s_oClass ; local oClassInstance ; local nScope ; nScope := 1 ; if s_oClass == NIL ; s_oClass := IIF(.F.,, HBClass():New( "TDataCenter" , { HBObject():Classh } ) ) ;

   _HB_MEMBER { cDataDictionaryFile} ; IIF( !.F., s_oClass:AddMultiClsData(, cAdsUNC() + "GstApolo.Add", nScope + IIF( .F., 32, 0 ) + 64, { "cDataDictionaryFile" }, .F. ), )
   _HB_MEMBER { cDataDictionaryComment} ; IIF( !.F., s_oClass:AddMultiClsData(, "GstApolo ADS data dictionary", nScope + IIF( .F., 32, 0 ) + 64, { "cDataDictionaryComment" }, .F. ), )

   _HB_MEMBER { aDDTables} ; IIF( !.F., s_oClass:AddMultiClsData(, {}, nScope + IIF( .F., 32, 0 ) + 64, { "aDDTables" }, .F. ), )
   _HB_MEMBER { aDDTriggers} ; IIF( !.F., s_oClass:AddMultiClsData(, {}, nScope + IIF( .F., 32, 0 ) + 64, { "aDDTriggers" }, .F. ), )

   _HB_MEMBER { lAdsConnection} ; IIF( !.F., s_oClass:AddMultiClsData(,, nScope + IIF( .F., 32, 0 ) + 64, { "lAdsConnection" }, .F. ), )
   _HB_MEMBER { hAdsConnection} ; IIF( !.F., s_oClass:AddMultiClsData(,, nScope + IIF( .F., 32, 0 ) + 64, { "hAdsConnection" }, .F. ), )

   _HB_MEMBER { aEmpresas} ; IIF( !.F., s_oClass:AddMultiData(, {}, nScope + IIF( .F., 32, 0 ), { "aEmpresas" }, .F., .F. ), )

   _HB_MEMBER { aDataTables} ; IIF( !.F., s_oClass:AddMultiData(, {}, nScope + IIF( .F., 32, 0 ), { "aDataTables" }, .F., .F. ), )
   _HB_MEMBER { aEmpresaTables} ; IIF( !.F., s_oClass:AddMultiData(, {}, nScope + IIF( .F., 32, 0 ), { "aEmpresaTables" }, .F., .F. ), )

   _HB_MEMBER { oDlg} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oDlg" }, .F., .F. ), )
   _HB_MEMBER { oBrwEmpresas} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oBrwEmpresas" }, .F., .F. ), )

   _HB_MEMBER { oDlgAuditor} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oDlgAuditor" }, .F., .F. ), )
   _HB_MEMBER { oBrwOperation} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oBrwOperation" }, .F., .F. ), )

   _HB_MEMBER { oMtrActualiza} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oMtrActualiza" }, .F., .F. ), )
   _HB_MEMBER { nMtrActualiza} ; IIF( !.F., s_oClass:AddMultiData(, 0, nScope + IIF( .F., 32, 0 ), { "nMtrActualiza" }, .F., .F. ), )

   _HB_MEMBER { oMtrDiccionario} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oMtrDiccionario" }, .F., .F. ), )
   _HB_MEMBER { nMtrDiccionario} ; IIF( !.F., s_oClass:AddMultiData(, 0, nScope + IIF( .F., 32, 0 ), { "nMtrDiccionario" }, .F., .F. ), )

   _HB_MEMBER { oSayProceso} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oSayProceso" }, .F., .F. ), )
   _HB_MEMBER { cSayProceso} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cSayProceso" }, .F., .F. ), )

   _HB_MEMBER { oBtnOk} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oBtnOk" }, .F., .F. ), )
   _HB_MEMBER { oBntCancel} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oBntCancel" }, .F., .F. ), )

   _HB_MEMBER { lValidDlg} ; IIF( !.F., s_oClass:AddMultiData(, .T., nScope + IIF( .F., 32, 0 ), { "lValidDlg" }, .F., .F. ), )

   _HB_MEMBER { oPeriodo} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oPeriodo" }, .F., .F. ), )
   _HB_MEMBER { cPeriodo} ; IIF( !.F., s_oClass:AddMultiData(, "Mes en curso", nScope + IIF( .F., 32, 0 ), { "cPeriodo" }, .F., .F. ), )
   _HB_MEMBER { aPeriodo} ; IIF( !.F., s_oClass:AddMultiData(, {}, nScope + IIF( .F., 32, 0 ), { "aPeriodo" }, .F., .F. ), )

   _HB_MEMBER { oIniInf} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oIniInf" }, .F., .F. ), )
   _HB_MEMBER { dIniInf} ; IIF( !.F., s_oClass:AddMultiData(, CtoD( "01/01/" + Str( Year( Date() ) ) ), nScope + IIF( .F., 32, 0 ), { "dIniInf" }, .F., .F. ), )

   _HB_MEMBER { oFinInf} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oFinInf" }, .F., .F. ), )
   _HB_MEMBER { dFinInf} ; IIF( !.F., s_oClass:AddMultiData(, Date(), nScope + IIF( .F., 32, 0 ), { "dFinInf" }, .F., .F. ), )

   _HB_MEMBER { lAppend} ; IIF( !.F., s_oClass:AddMultiData(, .T., nScope + IIF( .F., 32, 0 ), { "lAppend" }, .F., .F. ), )
   _HB_MEMBER { lEdit} ; IIF( !.F., s_oClass:AddMultiData(, .T., nScope + IIF( .F., 32, 0 ), { "lEdit" }, .F., .F. ), )
   _HB_MEMBER { lDelete} ; IIF( !.F., s_oClass:AddMultiData(, .T., nScope + IIF( .F., 32, 0 ), { "lDelete" }, .F., .F. ), )

   _HB_MEMBER CreateDataDictionary(); IIF( .F., s_oClass:ModMethod( "CreateDataDictionary", @TDataCenter_CreateDataDictionary(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateDataDictionary", @TDataCenter_CreateDataDictionary(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER ConnectDataDictionary(); IIF( .F., s_oClass:ModMethod( "ConnectDataDictionary", @TDataCenter_ConnectDataDictionary(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "ConnectDataDictionary", @TDataCenter_ConnectDataDictionary(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER CreateDataUser( oDataUser); IIF( .F., s_oClass:ModMethod( "CreateDataUser", @TDataCenter_CreateDataUser(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateDataUser", @TDataCenter_CreateDataUser(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER CreateDataTable(); IIF( .F., s_oClass:ModMethod( "CreateDataTable", @TDataCenter_CreateDataTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateDataTable", @TDataCenter_CreateDataTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER CreateEmpresaTable(); IIF( .F., s_oClass:ModMethod( "CreateEmpresaTable", @TDataCenter_CreateEmpresaTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateEmpresaTable", @TDataCenter_CreateEmpresaTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER ReLoadTables(); IIF( .F., s_oClass:ModInline( "ReLoadTables", {|Self | Self, ( ::aDDTables := AdsDirectory() ) }, nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddInline( "ReLoadTables", {|Self | Self, ( ::aDDTables := AdsDirectory() ) }, nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ) )

   _HB_MEMBER CreateDataTrigger(); IIF( .F., s_oClass:ModMethod( "CreateDataTrigger", @TDataCenter_CreateDataTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateDataTrigger", @TDataCenter_CreateDataTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER CreateEmpresaTrigger(); IIF( .F., s_oClass:ModMethod( "CreateEmpresaTrigger", @TDataCenter_CreateEmpresaTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateEmpresaTrigger", @TDataCenter_CreateEmpresaTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER ExistTable( oTable); IIF( .F., s_oClass:ModMethod( "ExistTable", @TDataCenter_ExistTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "ExistTable", @TDataCenter_ExistTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER ExistTrigger( oTable); IIF( .F., s_oClass:ModMethod( "ExistTrigger", @TDataCenter_ExistTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "ExistTrigger", @TDataCenter_ExistTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER CreateTriggerUpdate( oTable); IIF( .F., s_oClass:ModMethod( "CreateTriggerUpdate", @TDataCenter_CreateTriggerUpdate(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateTriggerUpdate", @TDataCenter_CreateTriggerUpdate(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER CreateColumnTriggerUpdate( oTable, cTrigger); IIF( .F., s_oClass:ModMethod( "CreateColumnTriggerUpdate", @TDataCenter_CreateColumnTriggerUpdate(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateColumnTriggerUpdate", @TDataCenter_CreateColumnTriggerUpdate(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER CreateTriggerInsert( oTable); IIF( .F., s_oClass:ModMethod( "CreateTriggerInsert", @TDataCenter_CreateTriggerInsert(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateTriggerInsert", @TDataCenter_CreateTriggerInsert(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER CreateColumnTriggerInsert( oTable, cTrigger); IIF( .F., s_oClass:ModMethod( "CreateColumnTriggerInsert", @TDataCenter_CreateColumnTriggerInsert(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateColumnTriggerInsert", @TDataCenter_CreateColumnTriggerInsert(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER CreateTriggerDelete( oTable); IIF( .F., s_oClass:ModMethod( "CreateTriggerDelete", @TDataCenter_CreateTriggerDelete(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateTriggerDelete", @TDataCenter_CreateTriggerDelete(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER CreateColumnTriggerDelete( oTable, cTrigger); IIF( .F., s_oClass:ModMethod( "CreateColumnTriggerDelete", @TDataCenter_CreateColumnTriggerDelete(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateColumnTriggerDelete", @TDataCenter_CreateColumnTriggerDelete(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER AddTable( oTable); IIF( .F., s_oClass:ModMethod( "AddTable", @TDataCenter_AddTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "AddTable", @TDataCenter_AddTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER AddTrigger( oTable, cAction); IIF( .F., s_oClass:ModMethod( "AddTrigger", @TDataCenter_AddTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "AddTrigger", @TDataCenter_AddTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER DeleteAllTable(); IIF( .F., s_oClass:ModMethod( "DeleteAllTable", @TDataCenter_DeleteAllTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "DeleteAllTable", @TDataCenter_DeleteAllTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER BuildData(); IIF( .F., s_oClass:ModMethod( "BuildData", @TDataCenter_BuildData(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "BuildData", @TDataCenter_BuildData(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER BuildEmpresa(); IIF( .F., s_oClass:ModMethod( "BuildEmpresa", @TDataCenter_BuildEmpresa(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "BuildEmpresa", @TDataCenter_BuildEmpresa(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER BuildTrigger(); IIF( .F., s_oClass:ModMethod( "BuildTrigger", @TDataCenter_BuildTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "BuildTrigger", @TDataCenter_BuildTrigger(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER AddDataTable(oTable); IIF( .F., s_oClass:ModInline( "AddDataTable", {|Self,oTable | Self, aAdd( ::aDataTables, oTable ) }, nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddInline( "AddDataTable", {|Self,oTable | Self, aAdd( ::aDataTables, oTable ) }, nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ) )
   _HB_MEMBER AddEmpresaTable(oTable); IIF( .F., s_oClass:ModInline( "AddEmpresaTable", {|Self,oTable | Self, aAdd( ::aEmpresaTables, oTable ) }, nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddInline( "AddEmpresaTable", {|Self,oTable | Self, aAdd( ::aEmpresaTables, oTable ) }, nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ) )

   _HB_MEMBER CreateOperationLogTable(); IIF( .F., s_oClass:ModMethod( "CreateOperationLogTable", @TDataCenter_CreateOperationLogTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateOperationLogTable", @TDataCenter_CreateOperationLogTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER CreateColumnLogTable(); IIF( .F., s_oClass:ModMethod( "CreateColumnLogTable", @TDataCenter_CreateColumnLogTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "CreateColumnLogTable", @TDataCenter_CreateColumnLogTable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lAdministratorTask(); IIF( .F., s_oClass:ModMethod( "lAdministratorTask", @TDataCenter_lAdministratorTask(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lAdministratorTask", @TDataCenter_lAdministratorTask(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER StartAdministratorTask(); IIF( .F., s_oClass:ModMethod( "StartAdministratorTask", @TDataCenter_StartAdministratorTask(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "StartAdministratorTask", @TDataCenter_StartAdministratorTask(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER Auditor(); IIF( .F., s_oClass:ModMethod( "Auditor", @TDataCenter_Auditor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "Auditor", @TDataCenter_Auditor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER StartAuditor( ); IIF( !.F., s_oClass:AddVirtual( "StartAuditor" ), )
   _HB_MEMBER lValidAuditor(); IIF( .F., s_oClass:ModMethod( "lValidAuditor", @TDataCenter_lValidAuditor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lValidAuditor", @TDataCenter_lValidAuditor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lSelectAuditor(); IIF( .F., s_oClass:ModMethod( "lSelectAuditor", @TDataCenter_lSelectAuditor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lSelectAuditor", @TDataCenter_lSelectAuditor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER cTableDescription( cTableName); IIF( .F., s_oClass:ModMethod( "cTableDescription", @TDataCenter_cTableDescription(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "cTableDescription", @TDataCenter_cTableDescription(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lCreaArrayPeriodos(); IIF( .F., s_oClass:ModMethod( "lCreaArrayPeriodos", @TDataCenter_lCreaArrayPeriodos(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lCreaArrayPeriodos", @TDataCenter_lCreaArrayPeriodos(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lRecargaFecha(); IIF( .F., s_oClass:ModMethod( "lRecargaFecha", @TDataCenter_lRecargaFecha(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lRecargaFecha", @TDataCenter_lRecargaFecha(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

; IF .F. ; __clsActive(s_oClass:hClass) ; s_oClass:Refresh() ; ELSE ; s_oClass:Create() ; END ; oClassInstance := __clsInst( s_oClass:hClass ) ; IF __ObjHasMsg( oClassInstance, "InitClass" ); oClassInstance:InitClass( hb_aParams() ) ; END ; ELSE ; oClassInstance := __clsInst( s_oClass:hClass ) ; END ; IF PCount() > 0 ; DIVERT TO (@DivertConstructorCall()) OF s_oClass ; END ; RETURN oClassInstance AS CLASS TDataCenter ;



UTILITY STATIC function TDataCenter_lAdministratorTask() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local dbfEmp

   lAIS( .F. )
   lCdx( .T. )

   ::aEmpresas       := {}





   dbUseArea( .T., ( cDriver() ), ( cAdsUNC() + "Datos\Empresa.Dbf" ), ( cCheckArea( "EMPRESA", @dbfEmp ) ), if(.T. .OR. .F., !.F., NIL), .F.,, )
   if !lAIS() ; ordListAdd( ( cAdsUNC() + "Datos\Empresa.Cdx" ) ) ; else ; ordSetFocus( 1 ) ; end

   while !( dbfEmp )->( eof() )
      aAdd( ::aEmpresas, { ( dbfEmp )->CodEmp, ( dbfEmp )->cNombre, ( dbfEmp )->lGrupo, .F., .F. } )
      ( dbfEmp )->( dbSkip() )
   end

   ( dbfEmp )->( dbCloseArea() )









   if !Empty( ::aEmpresas )

      ::oDlg = TDialog():New(,,,, "Creación de diccionario de datos para " + ::cDataDictionaryFile, "AdsAdmin",, .F.,,,,,, .F.,,,,,, .F., )

      ::oBrwEmpresas                         := TXBrowse():New( ::oDlg )

      ::oBrwEmpresas:lRecordSelector         := .T.
      ::oBrwEmpresas:lTransparent            := .F.
      ::oBrwEmpresas:nDataLines              := 1

      ::oBrwEmpresas:nMarqueeStyle           := 5

      ::oBrwEmpresas:bClrSel                 := {|| { 16777215, ( 53 + ( 142 * 256 ) + ( 182 * 65536 ) ) } }
      ::oBrwEmpresas:bClrSelFocus            := {|| { 16777215, ( 53 + ( 142 * 256 ) + ( 182 * 65536 ) ) } }

      ::oBrwEmpresas:CreateFromResource( 100 )

      ::oBrwEmpresas:SetArray( ::aEmpresas, , , .F. )

      with object ( ::oBrwEmpresas:AddCol() )
         :cHeader          := "Ac. Actualizada"
         :bStrData         := {|| "" }
         :nWidth           := 20
         :bEditValue       := {|| ::aEmpresas[ ::oBrwEmpresas:nArrayAt, 4 ] }
         :SetCheck( { "Bullet_Square_Green_16", "Bullet_Square_Red_16" } )
      end

      with object ( ::oBrwEmpresas:AddCol() )
         :cHeader          := "Pr. Procesada"
         :bStrData         := {|| "" }
         :nWidth           := 20
         :bEditValue       := {|| ::aEmpresas[ ::oBrwEmpresas:nArrayAt, 5 ] }
         :SetCheck( { "Bullet_Square_Green_16", "Bullet_Square_Red_16" } )
      end

      with object ( ::oBrwEmpresas:AddCol() )
         :cHeader          := "Código"
         :nWidth           := 40
         :bEditValue       := {|| if( ::aEmpresas[ ::oBrwEmpresas:nArrayAt, 3 ], "<" + Rtrim( ::aEmpresas[ ::oBrwEmpresas:nArrayAt, 1 ] ) + ">", ::aEmpresas[ ::oBrwEmpresas:nArrayAt, 1 ] ) }
      end

      with object ( ::oBrwEmpresas:AddCol() )
         :cHeader          := "Empresa"
         :nWidth           := 340
         :bEditValue       := {|| if( ::aEmpresas[ ::oBrwEmpresas:nArrayAt, 3 ], "<" + Rtrim( ::aEmpresas[ ::oBrwEmpresas:nArrayAt, 2 ] ) + ">", ::aEmpresas[ ::oBrwEmpresas:nArrayAt, 2 ] ) }
      end




      ::oSayProceso := TSay():ReDefine( 400, {||            ::cSayProceso}, ::oDlg,,,, .F.,, .F., .F. )

      ::oMtrActualiza      := TMeter():ReDefine( 500, { | u | if( pCount() == 0, ::nMtrActualiza, ::nMtrActualiza := u ) }, 10, ::oDlg, .F., , , .T., ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), , ( 128 + ( 255 * 256 ) + ( 0 * 65536 ) ) )

      ::oMtrDiccionario    := TMeter():ReDefine( 510, { | u | if( pCount() == 0, ::nMtrDiccionario, ::nMtrDiccionario := u ) }, 10, ::oDlg, .F., , , .T., ( 255 + ( 255 * 256 ) + ( 255 * 65536 ) ), , ( 128 + ( 255 * 256 ) + ( 0 * 65536 ) ) )




      ::oBtnOk := TButton():ReDefine( 1, {||( ::StartAdministratorTask() )}, ::oDlg,,, .F.,,,, .F. )




      ::oBntCancel := TButton():ReDefine( 2, {||( ::oDlg:end() )}, ::oDlg,,, .F.,,,, .F. )

      ::oDlg:AddFastKey( 116, {|| ::StartAdministratorTask() } )

      ::oDlg:Activate( , , , .T., {|| ::lValidDlg } )

   else

      MsgStop( "No hay empresas que procesar" )

   end

RETURN ( Self )



UTILITY STATIC function TDataCenter_StartAdministratorTask() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local cEmp

   ::lValidDlg       := .F.

   ::oBtnOk:Disable()
   ::oBntCancel:Disable()

   ::oMtrActualiza:SetTotal( len( ::aEmpresas ) )
   ::oMtrDiccionario:SetTotal( 5 )





   ::oBrwEmpresas:GoTop()

   for each cEmp in ::aEmpresas

      ::oSayProceso:SetText( "Actualizando empresa " + Rtrim( cEmp[ 1 ] ) + " - " + Rtrim( cEmp[ 2 ] ) )

      ::oMtrActualiza:Set( hb_EnumIndex() )

      if cEmp[ 3 ]
         lActualizaGrupo( cEmp[ 1 ], cEmp[ 2 ] )
      else
         SetEmpresa( cEmp[ 1 ], , , , , , .T. )
         lActualiza( cEmp[ 1 ], , .T., cEmp[ 2 ], .F. )
      end

      cEmp[ 4 ]      := .T.

      ::oBrwEmpresas:GoDown()
      ::oBrwEmpresas:Refresh()

   next

   ::oMtrDiccionario:Set( 1 )





   lCdx( .F. )
   lAIS( .T. )

   if ::ConnectDataDictionary()





      ::oSayProceso:SetText( "Eliminando tablas anteriores de diccionario de datos" )

      ::DeleteAllTable()





      ::oSayProceso:SetText( "Creando arbol de tablas datos generales aplicación" )

      ::BuildData()
      ::CreateDataTable()





      ::oBrwEmpresas:GoTop()

      for each cEmp in ::aEmpresas

         ::oSayProceso:SetText( "Creando diccionario de empresa " + Rtrim( cEmp[ 1 ] ) + " - " + Rtrim( cEmp[ 2 ] ) )

         ::oMtrActualiza:Set( hb_EnumIndex() )

         SetEmpresa( cEmp[ 1 ], , , , , , .T. )

         ::BuildEmpresa()
         ::CreateEmpresaTable()

         cEmp[ 5 ]   := .T.

         ::oBrwEmpresas:GoDown()
         ::oBrwEmpresas:Refresh()

      next

      ::oMtrDiccionario:Set( 2 )





      ::oSayProceso:SetText( "Creando tablas de operaciones" )

      ::CreateOperationLogTable()

      ::CreateColumnLogTable()

      ::oMtrDiccionario:Set( 3 )





      ::oSayProceso:SetText( "Creando triggers de datos" )

      ::CreateDataTrigger()

      ::oMtrDiccionario:Set( 4 )





      ::oSayProceso:SetText( "Creando triggers de empresa" )

      ::CreateEmpresaTrigger()

      ::oMtrDiccionario:Set( 5 )

   end





   ::lValidDlg       := .T.

   MsgInfo( "Proceso finalizado con exito" )

   ::oDlg:End()

RETURN ( Self )



UTILITY STATIC function TDataCenter_CreateDataDictionary() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   if !File( ::cDataDictionaryFile )

      msgInfo( ::cDataDictionaryFile, "Create" )

      AdsDDCreate( ::cDataDictionaryFile, , ::cDataDictionaryComment )

      AdsDDSetDatabaseProperty( 107, .T. )

   end

RETURN ( Self )



UTILITY STATIC function TDataCenter_ConnectDataDictionary() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local cError

   ::CreateDataDictionary()

   ::lAdsConnection     := AdsConnect60( ::cDataDictionaryFile, 2, "ADSSYS", "", , @::hAdsConnection )

   if !::lAdsConnection

      adsGetLastError( @cError )

      msgInfo( cError, "Error connect data dictionary " + ::cDataDictionaryFile )

   end

RETURN ( ::lAdsConnection )



UTILITY STATIC function TDataCenter_CreateDataUser( oDataUser) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   if !Empty( oDataUser:cName ) .AND. !Empty( oDataUser:cPassword )
      AdsDDCreateUser( , oDataUser:cName, oDataUser:cPassword, oDataUser:cComment )
   end

RETURN ( Self )



UTILITY STATIC function TDataCenter_CreateDataTable() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local oTable

   for each oTable in ::aDataTables
      ::AddTable( oTable )
   next

   ::ReLoadTables()

RETURN ( Self )



UTILITY STATIC function TDataCenter_CreateDataTrigger() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local oTable

   ::oMtrActualiza:SetTotal( len( ::aDataTables ) )

   for each oTable in ::aDataTables

      ::oMtrActualiza:Set( hb_EnumIndex() )

      if oTable:lTrigger
         ::AddTrigger( oTable )
      end

   next

RETURN ( Self )



UTILITY STATIC function TDataCenter_CreateEmpresaTable() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local oTable

   for each oTable in ::aEmpresaTables
      ::AddTable( oTable )
   next

   ::ReLoadTables()

RETURN ( Self )



UTILITY STATIC function TDataCenter_CreateEmpresaTrigger() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local oTable

   ::oMtrActualiza:SetTotal( len( ::aEmpresaTables ) )

   for each oTable in ::aEmpresaTables

      ::oMtrActualiza:Set( hb_EnumIndex() )

      if oTable:lTrigger
         ::AddTrigger( oTable )
      end

   next

RETURN ( Self )



UTILITY STATIC function TDataCenter_ExistTable( uTable) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local cTable

   do case
   case IsObject( uTable )
      cTable         := Upper( uTable:cName )
   case IsChar( uTable )
      cTable         := Upper( uTable )
   end

   if Empty( ::aDDTables )
      ::aDDTables    := AdsDirectory()
   end

Return ( aScan( ::aDDTables, {|c| Left( Upper( c ), len( c ) - 1 ) == cTable } ) <> 0 )



UTILITY STATIC function TDataCenter_DeleteAllTable() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   if Empty( ::aDDTables )
      ::aDDTables    := AdsDirectory()
   end

   aEval( ::aDDTables, {|c| AdsDDRemoveTable( Left( Upper( c ), len( c ) - 1 ) ) } )

   ::ReLoadTables()

Return ( Self )



UTILITY STATIC function TDataCenter_ExistTrigger( oTable) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local cTrigger

   if !isObject( oTable )
      Return ( .F. )
   end

   if Empty( ::aDDTriggers )
      ::aDDTriggers  := ADSSelectSQLScript( "SELECT name FROM system.triggers" )
   end

Return ( aScan( ::aDDTriggers, {|c| Upper( Alltrim( oTable:cName ) ) $ Upper( Alltrim( c ) ) } ) <> 0 )



UTILITY STATIC function TDataCenter_CreateTriggerUpdate( oTable) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local nError
   local cTrigger
   local lTrigger
   local cErrorAds

   if !isObject( oTable )
      Return ( .F. )
   end

   cTrigger          := ""
   cTrigger          += 'CREATE TRIGGER "Update' + ( Alltrim( oTable:cName ) ) + '" ON "' + ( Alltrim( oTable:cName ) ) + '" AFTER UPDATE' + Chr(13)+Chr(10)

   cTrigger          += "BEGIN" + Chr(13)+Chr(10)

   cTrigger          += "DECLARE @id Integer;" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @co CURSOR AS SELECT * FROM __OLD;" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @cn CURSOR AS SELECT * FROM __NEW;" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @userName NCHAR(50);" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @appName NCHAR(50);" + Chr(13)+Chr(10)

   cTrigger          += "@userName = USER();" + Chr(13)+Chr(10)
   cTrigger          += "@appName = APPLICATIONID();" + Chr(13)+Chr(10)

   cTrigger          += "OPEN @co;" + Chr(13)+Chr(10)
   cTrigger          += "OPEN @cn;" + Chr(13)+Chr(10)

   cTrigger          += "TRY" + Chr(13)+Chr(10)

   cTrigger          += "FETCH @co;" + Chr(13)+Chr(10)
   cTrigger          += "FETCH @cn;" + Chr(13)+Chr(10)

   cTrigger          += "INSERT INTO SqlOperationLog ( DATETIME, USERNAME, APPNAME, TABLENAME, OPERATION )" + Chr(13)+Chr(10)
   cTrigger          += "VALUES ( Now(), @userName, @appName, " + "'" + ( Alltrim( oTable:cName ) ) + "'" + ", 'UPDATE'" + " );" + Chr(13)+Chr(10)

   cTrigger          += "@id = LASTAUTOINC(STATEMENT);" + Chr(13)+Chr(10)

   ::CreateColumnTriggerUpdate( oTable, @cTrigger )

   cTrigger          += "FINALLY" + Chr(13)+Chr(10)

   cTrigger          += "CLOSE @co;" + Chr(13)+Chr(10)
   cTrigger          += "CLOSE @cn;" + Chr(13)+Chr(10)

   cTrigger          += "END TRY;" + Chr(13)+Chr(10)

   cTrigger          += "END NO MEMOS PRIORITY 1;" + Chr(13)+Chr(10)

   dbSelectArea( 0 )

   if ADSCreateSQLStatement( ( Alltrim( oTable:cName ) ), 2 )

      lTrigger    := ADSExecuteSQLDirect( cTrigger )
      if !lTrigger

         nError   := AdsGetLastError( @cErrorAds )
         msgStop( cErrorAds + Chr(13)+Chr(10) + cTrigger, "ERROR CREATE TRIGGER en ADSExecuteSQLDirect" )

         Return ( Self )

      endif

   else

      nError      := AdsGetLastError( @cErrorAds )
      msgStop( cErrorAds + Chr(13)+Chr(10) + cTrigger, "ERROR CREATE TRIGGER en ADSCreateSQLStatement" )

   end

Return ( Self )



UTILITY STATIC function TDataCenter_CreateColumnTriggerUpdate( oTable, cTrigger) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local n
   local oError
   local oBlock

   oBlock         := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   dbUseArea( .T., cDriver(), oTable:cName, "Table" )

   for n := 1 to Table->( fCount() )

      if Table->( FieldType( n ) ) <> "M"







         cTrigger += 'IF ( @co."' + Table->( FieldName( n ) ) + '" <> @cn."' + Table->( FieldName( n ) ) + '" )' + Chr(13)+Chr(10)
         cTrigger +=     "THEN" + Chr(13)+Chr(10)
         cTrigger += "INSERT INTO SqlColumnLog ( OPERATIONID, COLUMNNAME, USERNAME, APPNAME, TABLENAME, OLDVALUE, NEWVALUE )" + Chr(13)+Chr(10)
         cTrigger += "VALUES ( @id, " + "'" + Table->( FieldName( n ) ) + "'" + ", @userName, @appName, " + "'" + Alltrim( oTable:cName ) + "'" + ", cast( @co." + '"' + Table->( FieldName( n ) ) + '"' + " as sql_varchar ), " + "cast( @cn." + '"' + Table->( FieldName( n ) ) + '"' + " as sql_varchar ) );" + Chr(13)+Chr(10)
         cTrigger += "END IF;" + Chr(13)+Chr(10)
         cTrigger += Chr(13)+Chr(10)

      end

   next

   Table->( dbCloseArea() )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible crear las columnas del trigger" )

   end

   ErrorBlock( oBlock )

Return ( Self )



UTILITY STATIC function TDataCenter_CreateTriggerInsert( oTable, cAction) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local nError
   local cTrigger
   local lTrigger
   local cErrorAds

   if !isObject( oTable )
      Return ( .F. )
   end

   cTrigger          := ""
   cTrigger          += 'CREATE TRIGGER "Insert' + ( Alltrim( oTable:cName ) ) + '" ON "' + ( Alltrim( oTable:cName ) ) + '" AFTER INSERT' + Chr(13)+Chr(10)

   cTrigger          += "BEGIN" + Chr(13)+Chr(10)

   cTrigger          += "DECLARE @id Integer;" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @cn CURSOR AS SELECT * FROM __NEW;" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @userName NCHAR(50);" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @appName NCHAR(50);" + Chr(13)+Chr(10)

   cTrigger          += "@userName = USER();" + Chr(13)+Chr(10)
   cTrigger          += "@appName = APPLICATIONID();" + Chr(13)+Chr(10)

   cTrigger          += "OPEN @cn;" + Chr(13)+Chr(10)

   cTrigger          += "TRY" + Chr(13)+Chr(10)

   cTrigger          += "FETCH @cn;" + Chr(13)+Chr(10)

   cTrigger          += "INSERT INTO SqlOperationLog ( DATETIME, USERNAME, APPNAME, TABLENAME, OPERATION )" + Chr(13)+Chr(10)
   cTrigger          += "VALUES ( Now(), @userName, @appName, " + "'" + ( Alltrim( oTable:cName ) ) + "'" + ", 'INSERT'" + " );" + Chr(13)+Chr(10)

   cTrigger          += "@id = LASTAUTOINC(STATEMENT);" + Chr(13)+Chr(10)

   ::CreateColumnTriggerInsert( oTable, @cTrigger )

   cTrigger          += "FINALLY" + Chr(13)+Chr(10)

   cTrigger          += "CLOSE @cn;" + Chr(13)+Chr(10)

   cTrigger          += "END TRY;" + Chr(13)+Chr(10)

   cTrigger          += "END NO MEMOS PRIORITY 1;" + Chr(13)+Chr(10)

   dbSelectArea( 0 )

   if ADSCreateSQLStatement( ( Alltrim( oTable:cName ) ), 2 )

      lTrigger    := ADSExecuteSQLDirect( cTrigger )
      if !lTrigger

         nError   := AdsGetLastError( @cErrorAds )
         msgStop( cErrorAds + Chr(13)+Chr(10) + cTrigger, "ERROR CREATE TRIGGER en ADSExecuteSQLDirect" )

         Return ( Self )

      endif

   else

      nError      := AdsGetLastError( @cErrorAds )
      msgStop( cErrorAds + Chr(13)+Chr(10) + cTrigger, "ERROR CREATE TRIGGER en ADSCreateSQLStatement" )

   end

Return ( Self )



UTILITY STATIC function TDataCenter_CreateColumnTriggerInsert( oTable, cTrigger) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local n
   local oError
   local oBlock

   oBlock         := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   dbUseArea( .T., cDriver(), oTable:cName, "Table" )

   for n := 1 to Table->( fCount() )

      if Table->( FieldType( n ) ) <> "M"

         cTrigger += "INSERT INTO SqlColumnLog ( OPERATIONID, COLUMNNAME, USERNAME, APPNAME, TABLENAME, OLDVALUE, NEWVALUE )" + Chr(13)+Chr(10)
         cTrigger += "VALUES ( @id, " + "'" + Table->( FieldName( n ) ) + "'" + ", @userName, @appName, " + "'" + Alltrim( oTable:cName ) + "'" + ", '', " + "cast( @cn." + '"' + Table->( FieldName( n ) ) + '"' + " as sql_varchar ) );" + Chr(13)+Chr(10)
         cTrigger += Chr(13)+Chr(10)

      end

   next

   Table->( dbCloseArea() )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible crear las columnas del trigger insert" )

   end

   ErrorBlock( oBlock )

Return ( Self )



UTILITY STATIC function TDataCenter_CreateTriggerDelete( oTable, cAction) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local nError
   local cTrigger
   local lTrigger
   local cErrorAds

   if !isObject( oTable )
      Return ( .F. )
   end

   cTrigger          := ""
   cTrigger          += 'CREATE TRIGGER "Delete' + ( Alltrim( oTable:cName ) ) + '" ON "' + ( Alltrim( oTable:cName ) ) + '" AFTER DELETE' + Chr(13)+Chr(10)

   cTrigger          += "BEGIN" + Chr(13)+Chr(10)

   cTrigger          += "DECLARE @id Integer;" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @co CURSOR AS SELECT * FROM __OLD;" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @userName NCHAR(50);" + Chr(13)+Chr(10)
   cTrigger          += "DECLARE @appName NCHAR(50);" + Chr(13)+Chr(10)

   cTrigger          += "@userName = USER();" + Chr(13)+Chr(10)
   cTrigger          += "@appName = APPLICATIONID();" + Chr(13)+Chr(10)

   cTrigger          += "OPEN @co;" + Chr(13)+Chr(10)

   cTrigger          += "TRY" + Chr(13)+Chr(10)

   cTrigger          += "FETCH @co;" + Chr(13)+Chr(10)

   cTrigger          += "INSERT INTO SqlOperationLog ( DATETIME, USERNAME, APPNAME, TABLENAME, OPERATION )" + Chr(13)+Chr(10)
   cTrigger          += "VALUES ( Now(), @userName, @appName, " + "'" + ( Alltrim( oTable:cName ) ) + "'" + ", 'DELETE'" + " );" + Chr(13)+Chr(10)

   cTrigger          += "@id = LASTAUTOINC(STATEMENT);" + Chr(13)+Chr(10)

   ::CreateColumnTriggerDelete( oTable, @cTrigger )

   cTrigger          += "FINALLY" + Chr(13)+Chr(10)

   cTrigger          += "CLOSE @co;" + Chr(13)+Chr(10)

   cTrigger          += "END TRY;" + Chr(13)+Chr(10)

   cTrigger          += "END NO MEMOS PRIORITY 1;" + Chr(13)+Chr(10)

   dbSelectArea( 0 )

   if ADSCreateSQLStatement( ( Alltrim( oTable:cName ) ), 2 )

      lTrigger    := ADSExecuteSQLDirect( cTrigger )
      if !lTrigger

         nError   := AdsGetLastError( @cErrorAds )
         msgStop( cErrorAds + Chr(13)+Chr(10) + cTrigger, "ERROR CREATE TRIGGER en ADSExecuteSQLDirect" )

         Return ( Self )

      endif

   else

      nError      := AdsGetLastError( @cErrorAds )
      msgStop( cErrorAds + Chr(13)+Chr(10) + cTrigger, "ERROR CREATE TRIGGER en ADSCreateSQLStatement" )

   end

Return ( Self )



UTILITY STATIC function TDataCenter_CreateColumnTriggerDelete( oTable, cTrigger) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local n
   local oError
   local oBlock

   oBlock         := ErrorBlock( { | oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   dbUseArea( .T., cDriver(), oTable:cName, "Table" )

   for n := 1 to Table->( fCount() )

      if Table->( FieldType( n ) ) <> "M"

         cTrigger += "INSERT INTO SqlColumnLog ( OPERATIONID, COLUMNNAME, USERNAME, APPNAME, TABLENAME, OLDVALUE, NEWVALUE )" + Chr(13)+Chr(10)
         cTrigger += "VALUES ( @id, " + "'" + Table->( FieldName( n ) ) + "'" + ", @userName, @appName, " + "'" + Alltrim( oTable:cName ) + "'" + ", '', " + "cast( @co." + '"' + Table->( FieldName( n ) ) + '"' + " as sql_varchar ) );" + Chr(13)+Chr(10)
         cTrigger += Chr(13)+Chr(10)

      end

   next

   Table->( dbCloseArea() )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible crear las columnas del trigger delete" )

   end

   ErrorBlock( oBlock )

Return ( Self )



UTILITY STATIC function TDataCenter_AddTable( oTable) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local cError
   local lAddTable      := .T.

   if !::ExistTable( oTable )

      if file( oTable:cDataFile ) .AND. file( oTable:cIndexFile )

         if !AdsDDaddTable( oTable:cName, oTable:cDataFile, oTable:cIndexFile )

            lAddTable   := .F.





            msgStop(    "Name  : " + Alltrim( oTable:cName )      + Chr(13)+Chr(10) +  "Table : " + Alltrim( oTable:cDataFile )  + Chr(13)+Chr(10) +  "Index : " + Alltrim( oTable:cIndexFile ) + Chr(13)+Chr(10) +  "Descripción de error " + cValToChar( adsGetLastError( @cError ) ), "Error adding table" )

         end

      else

         if !file( oTable:cDataFile )
            msgWait( "No existe " + ( oTable:cDataFile ), "Atención", 1 )
         end

         if !file( oTable:cIndexFile )
            msgWait( "No existe " + ( oTable:cIndexFile ), "Atención", 1 )
         end

      end

   end

Return ( lAddTable )



UTILITY STATIC function TDataCenter_AddTrigger( oTable, cAction) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   ::CreateTriggerInsert( oTable )
   ::CreateTriggerUpdate( oTable )
   ::CreateTriggerDelete( oTable )

Return ( Self )



UTILITY STATIC function TDataCenter_BuildData() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local oDataTable

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Users"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Users.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Users.Cdx"
   oDataTable:cDescription := "Usuarios"
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Mapas"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Mapas.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Mapas.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Cajas"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Cajas.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Cajas.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "CajasL"
   oDataTable:cDataFile    := cPatDat( .T. ) + "CajasL.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "CajasL.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "ImpTik"
   oDataTable:cDataFile    := cPatDat( .T. ) + "ImpTik.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "ImpTik.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Visor"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Visor.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Visor.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "CajPorta"
   oDataTable:cDataFile    := cPatDat( .T. ) + "CajPorta.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "CajPorta.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "TipImp"
   oDataTable:cDataFile    := cPatDat( .T. ) + "TipImp.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "TipImp.Cdx"
   oDataTable:lTrigger     := .T.
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Agenda"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Agenda.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Agenda.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "AgendaUsr"
   oDataTable:cDataFile    := cPatDat( .T. ) + "AgendaUsr.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "AgendaUsr.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "TipoNotas"
   oDataTable:cDataFile    := cPatDat( .T. ) + "TipoNotas.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "TipoNotas.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "TVta"
   oDataTable:cDataFile    := cPatDat( .T. ) + "TVta.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "TVta.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Divisas"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Divisas.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Divisas.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "TIva"
   oDataTable:cDataFile    := cPatDat( .T. ) + "TIva.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "TIva.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Empresa"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Empresa.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Empresa.Cdx"
   oDataTable:lTrigger     := .F.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Delega"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Delega.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Delega.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "UsrBtnBar"
   oDataTable:cDataFile    := cPatDat( .T. ) + "UsrBtnBar.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "UsrBtnBar.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "TblCnv"
   oDataTable:cDataFile    := cPatDat( .T. ) + "TblCnv.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "TblCnv.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Captura"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Captura.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Captura.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "CapturaCampos"
   oDataTable:cDataFile    := cPatDat( .T. ) + "CapturaCampos.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "CapturaCampos.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "TMov"
   oDataTable:cDataFile    := cPatDat( .T. ) + "TMov.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "TMov.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "CnfFlt"
   oDataTable:cDataFile    := cPatDat( .T. ) + "CnfFlt.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "CnfFlt.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Situa"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Situa.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Situa.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Pais"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Pais.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Pais.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatDat() + "Backup"
   oDataTable:cDataFile    := cPatDat( .T. ) + "Backup.Dbf"
   oDataTable:cIndexFile   := cPatDat( .T. ) + "Backup.Cdx"
   oDataTable:lTrigger     := .T.
   ::AddDataTable( oDataTable )

RETURN ( Self )



UTILITY STATIC function TDataCenter_BuildEmpresa() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local oDataTable

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "NCount"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "NCount.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "NCount.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "EntSal"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "EntSal.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "EntSal.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "LogPorta"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "LogPorta.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "LogPorta.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatAlm() + "Almacen"
   oDataTable:cDataFile    := cPatAlm( , .T. ) + "Almacen.Dbf"
   oDataTable:cIndexFile   := cPatAlm( , .T. ) + "Almacen.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatAlm() + "AlmacenL"
   oDataTable:cDataFile    := cPatAlm( , .T. ) + "AlmacenL.Dbf"
   oDataTable:cIndexFile   := cPatAlm( , .T. ) + "AlmacenL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatGrp() + "FPago"
   oDataTable:cDataFile    := cPatGrp( , .T. ) + "FPago.Dbf"
   oDataTable:cIndexFile   := cPatGrp( , .T. ) + "FPago.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatGrp() + "Invita"
   oDataTable:cDataFile    := cPatGrp( , .T. ) + "Invita.Dbf"
   oDataTable:cIndexFile   := cPatGrp( , .T. ) + "Invita.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatGrp() + "Catalogo"
   oDataTable:cDataFile    := cPatGrp( , .T. ) + "Catalogo.Dbf"
   oDataTable:cIndexFile   := cPatGrp( , .T. ) + "Catalogo.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatGrp() + "UndMed"
   oDataTable:cDataFile    := cPatGrp( , .T. ) + "UndMed.Dbf"
   oDataTable:cIndexFile   := cPatGrp( , .T. ) + "UndMed.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatGrp() + "Bancos"
   oDataTable:cDataFile    := cPatGrp( , .T. ) + "Bancos.Dbf"
   oDataTable:cIndexFile   := cPatGrp( , .T. ) + "Bancos.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatGrp() + "EmpBnc"
   oDataTable:cDataFile    := cPatGrp( , .T. ) + "EmpBnc.Dbf"
   oDataTable:cIndexFile   := cPatGrp( , .T. ) + "EmpBnc.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "Turno"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "Turno.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "Turno.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TurnoC"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TurnoC.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TurnoC.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TurnoL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TurnoL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TurnoL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "NewImp"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "NewImp.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "NewImp.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "HisMov"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "HisMov.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "HisMov.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatAlm() + "UbiCat"
   oDataTable:cDataFile    := cPatAlm( , .T. ) + "UbiCat.Dbf"
   oDataTable:cIndexFile   := cPatAlm( , .T. ) + "UbiCat.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatAlm() + "UbiCal"
   oDataTable:cDataFile    := cPatAlm( , .T. ) + "UbiCal.Dbf"
   oDataTable:cIndexFile   := cPatAlm( , .T. ) + "UbiCal.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "GrpVent"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "GrpVent.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "GrpVent.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RemMovT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RemMovT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RemMovT.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Articulo"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Articulo.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Articulo.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "ProvArt"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "ProvArt.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "ProvArt.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "ArtDiv"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "ArtDiv.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "ArtDiv.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "ArtKit"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "ArtKit.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "ArtKit.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "ArtCodebar"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "ArtCodebar.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "ArtCodebar.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "ArtLbl"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "ArtLbl.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "ArtLbl.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "ArtImg"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "ArtImg.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "ArtImg.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Familias"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Familias.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Familias.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "FamPrv"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "FamPrv.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "FamPrv.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Temporadas"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Temporadas.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Temporadas.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Categorias"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Categorias.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Categorias.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "TipArt"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "TipArt.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "TipArt.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Fabricantes"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Fabricantes.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Fabricantes.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "TarPreT"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "TarPreT.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "TarPreT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "TarPreS"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "TarPreS.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "TarPreS.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "TarPreL"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "TarPreL.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "TarPreL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Oferta"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Oferta.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Oferta.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Pro"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Pro.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Pro.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "TblPro"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "TblPro.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "TblPro.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Tankes"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Tankes.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Tankes.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "GrpFam"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "GrpFam.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "GrpFam.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "FraPub"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "FraPub.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "FraPub.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "TComandas"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "TComandas.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "TComandas.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "ComentariosT"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "ComentariosT.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "ComentariosT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "ComentariosL"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "ComentariosL.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "ComentariosL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "PromoT"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "PromoT.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "PromoT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "PromoL"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "PromoL.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "PromoL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "PromoC"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "PromoC.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "PromoC.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "Fideliza"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "Fideliza.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "Fideliza.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatArt() + "DetFideliza"
   oDataTable:cDataFile    := cPatArt( , .T. ) + "DetFideliza.Dbf"
   oDataTable:cIndexFile   := cPatArt( , .T. ) + "DetFideliza.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "Client"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "Client.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "Client.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "ClientD"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "ClientD.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "ClientD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "CliAtp"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "CliAtp.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "CliAtp.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "GrpCli"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "GrpCli.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "GrpCli.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "ObrasT"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "ObrasT.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "ObrasT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "CliContactos"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "CliContactos.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "CliContactos.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "CliBnc"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "CliBnc.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "CliBnc.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "CliInc"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "CliInc.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "CliInc.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "Agentes"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "Agentes.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "Agentes.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "AgeCom"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "AgeCom.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "AgeCom.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "AgeRel"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "AgeRel.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "AgeRel.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "Transpor"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "Transpor.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "Transpor.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "Ruta"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "Ruta.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "Ruta.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatCli() + "CtaRem"
   oDataTable:cDataFile    := cPatCli( , .T. ) + "CtaRem.Dbf"
   oDataTable:cIndexFile   := cPatCli( , .T. ) + "CtaRem.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatPrv() + "GrpPrv"
   oDataTable:cDataFile    := cPatPrv( , .T. ) + "GrpPrv.Dbf"
   oDataTable:cIndexFile   := cPatPrv( , .T. ) + "GrpPrv.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatPrv() + "Provee"
   oDataTable:cDataFile    := cPatPrv( , .T. ) + "Provee.Dbf"
   oDataTable:cIndexFile   := cPatPrv( , .T. ) + "Provee.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatPrv() + "ProveeD"
   oDataTable:cDataFile    := cPatPrv( , .T. ) + "ProveeD.Dbf"
   oDataTable:cIndexFile   := cPatPrv( , .T. ) + "ProveeD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatPrv() + "PrvBnc"
   oDataTable:cDataFile    := cPatPrv( , .T. ) + "PrvBnc.Dbf"
   oDataTable:cIndexFile   := cPatPrv( , .T. ) + "PrvBnc.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RemAgeT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RemAgeT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RemAgeT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TipInci"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TipInci.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TipInci.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "CfgUse"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "CfgUse.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "CfgUse.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "CfgCol"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "CfgCol.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "CfgCol.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "CfgInf"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "CfgInf.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "CfgInf.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "CfgFnt"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "CfgFnt.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "CfgFnt.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "CfgGrp"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "CfgGrp.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "CfgGrp.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "DepAgeT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "DepAgeT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "DepAgeT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "DepAgeL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "DepAgeL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "DepAgeL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "MovSer"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "MovSer.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "MovSer.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RDocumen"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RDocumen.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RDocumen.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RItems"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RItems.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RItems.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RColum"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RColum.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RColum.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RBitmap"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RBitmap.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RBitmap.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RBox"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RBox.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RBox.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FstInf"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FstInf.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FstInf.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PrsInf"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PrsInf.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PrsInf.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedProvT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedProvT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedProvT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedProvL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedProvL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedProvL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedPrvI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedPrvI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedPrvI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedPrvD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedPrvD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedPrvD.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbProvT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbProvT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbProvT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbProvL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbProvL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbProvL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbPrvI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbPrvI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbPrvI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbPrvD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbPrvD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbPrvD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbPrvS"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbPrvS.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbPrvS.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacPrvT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacPrvT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacPrvT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacPrvL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacPrvL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacPrvL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacPrvI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacPrvI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacPrvI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacPrvD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacPrvD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacPrvD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacPrvP"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacPrvP.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacPrvP.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacPrvS"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacPrvS.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacPrvS.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RctPrvT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RctPrvT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RctPrvT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RctPrvL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RctPrvL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RctPrvL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RctPrvI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RctPrvI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RctPrvI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RctPrvD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RctPrvD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RctPrvD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RctPrvS"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RctPrvS.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RctPrvS.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PreCliT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PreCliT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PreCliT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PreCliL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PreCliL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PreCliL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PreCliI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PreCliI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PreCliI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PreCliD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PreCliD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PreCliD.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedCliT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedCliT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedCliT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedCliL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedCliL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedCliL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedCliI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedCliI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedCliI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedCliD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedCliD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedCliD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedCliP"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedCliP.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedCliP.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "PedCliR"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "PedCliR.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "PedCliR.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbCliT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbCliT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbCliT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbCliL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbCliL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbCliL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbCliI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbCliI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbCliI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbCliD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbCliD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbCliD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbCliP"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbCliP.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbCliP.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AlbCliS"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AlbCliS.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AlbCliS.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RemCliT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RemCliT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RemCliT.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "RemAgeL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "RemAgeL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "RemAgeL.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacCliT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacCliT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacCliT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacCliL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacCliL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacCliL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacCliI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacCliI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacCliI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacCliD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacCliD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacCliD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacCliP"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacCliP.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacCliP.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacCliS"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacCliS.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacCliS.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacRecT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacRecT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacRecT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacRecL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacRecL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacRecL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacRecI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacRecI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacRecI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacRecD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacRecD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacRecD.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacRecS"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacRecS.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacRecS.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacAutT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacAutT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacAutT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacAutL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacAutL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacAutL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "FacAutI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "FacAutI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "FacAutI.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AntCliT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AntCliT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AntCliT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AntCliI"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AntCliI.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AntCliI.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "AntCliD"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "AntCliD.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "AntCliD.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TikeT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TikeT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TikeT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TikeL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TikeL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TikeL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TikeP"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TikeP.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TikeP.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TikeS"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TikeS.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TikeS.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TikeM"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TikeM.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TikeM.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "SalaVta"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "SalaVta.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "SalaVta.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "SlaPnt"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "SlaPnt.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "SlaPnt.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ProCab"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ProCab.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ProCab.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ProLin"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ProLin.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ProLin.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ProSer"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ProSer.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ProSer.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ProMat"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ProMat.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ProMat.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ProMaq"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ProMaq.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ProMaq.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "MaqCosT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "MaqCosT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "MaqCosT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "MaqCosL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "MaqCosL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "MaqCosL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "Costes"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "Costes.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "Costes.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ProPer"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ProPer.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ProPer.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "OpeT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "OpeT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "OpeT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "OpeL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "OpeL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "OpeL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "Operacio"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "Operacio.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "Operacio.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "Seccion"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "Seccion.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "Seccion.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "Horas"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "Horas.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "Horas.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ProHPer"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ProHPer.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ProHPer.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "MatSer"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "MatSer.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "MatSer.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TipOpera"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TipOpera.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TipOpera.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ExtAgeT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ExtAgeT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ExtAgeT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ExtAgeL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ExtAgeL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ExtAgeL.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "OrdCarP"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "OrdCarP.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "OrdCarP.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "OrdCarL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "OrdCarL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "OrdCarL.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ExpCab"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ExpCab.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ExpCab.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "ExpDet"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "ExpDet.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "ExpDet.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TipExpT"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TipExpT.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TipExpT.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "TipExpL"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "TipExpL.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "TipExpL.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "Entidades"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "Entidades.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "Entidades.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "Colaboradores"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "Colaboradores.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "Colaboradores.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "Actuaciones"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "Actuaciones.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "Actuaciones.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "SndLog"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "SndLog.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "SndLog.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "SndFil"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "SndFil.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "SndFil.Cdx"
   ::AddEmpresaTable( oDataTable )





   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "CfgCar"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "CfgCar.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "CfgCar.Cdx"
   ::AddEmpresaTable( oDataTable )

   oDataTable              := TDataTable()
   oDataTable:cName        := cPatEmp() + "CfgFav"
   oDataTable:cDataFile    := cPatEmp( , .T. ) + "CfgFav.Dbf"
   oDataTable:cIndexFile   := cPatEmp( , .T. ) + "CfgFav.Cdx"
   ::AddEmpresaTable( oDataTable )

RETURN ( Self )



UTILITY STATIC function TDataCenter_BuildTrigger() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   with object ( TAuditor() )
      :Create( cPatDat() )


   end

RETURN ( Self )



UTILITY STATIC function TDataCenter_CreateOperationLogTable() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local nError
   local cTable
   local lTrigger
   local cErrorAds

   if File( "SqlOperationLog.adt" )
      fErase( "SqlOperationLog.adt" )
   end

   cTable         := "CREATE TABLE SqlOperationLog (" + Chr(13)+Chr(10)
   cTable         += "ID AUTOINC CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "DATETIME TIMESTAMP CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "USERNAME CHAR(50) CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "APPNAME CHAR(50)," + Chr(13)+Chr(10)
   cTable         += "TABLENAME CHAR(150) CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "OPERATION CHAR(6) CONSTRAINT NOT NULL )" + Chr(13)+Chr(10)
   cTable         += "IN DATABASE;" + Chr(13)+Chr(10)

   dbSelectArea( 0 )

   if ADSCreateSQLStatement( "OperationLog", 3 )

      lTrigger    := ADSExecuteSQLDirect( cTable )
      if !lTrigger
         nError   := AdsGetLastError( @cErrorAds )
         msgStop( cErrorAds + Chr(13)+Chr(10) + cTable, "ERROR CREATE TABLE en ADSExecuteSQLDirect" )
      endif

   else

      nError      := AdsGetLastError( @cErrorAds )
      msgStop( cErrorAds + Chr(13)+Chr(10) + cTable, "ERROR CREATE TABLE en ADSCreateSQLStatement" )

   end

   AdsCacheOpenCursors( 0 )
   AdsClrCallBack()

Return ( Self )



UTILITY STATIC function TDataCenter_CreateColumnLogTable() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local nError
   local cTable
   local lTrigger
   local cErrorAds

   if File( "SqlColumnLog.adt" )
      fErase( "SqlColumnLog.adt" )
   end

   cTable         := "CREATE TABLE SqlColumnLog (" + Chr(13)+Chr(10)
   cTable         += "ID AUTOINC CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "OPERATIONID INTEGER CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "COLUMNNAME CHAR(50) CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "USERNAME CHAR(50) CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "APPNAME CHAR(50)," + Chr(13)+Chr(10)
   cTable         += "TABLENAME CHAR(150) CONSTRAINT NOT NULL," + Chr(13)+Chr(10)
   cTable         += "OLDVALUE CHAR(250)," + Chr(13)+Chr(10)
   cTable         += "NEWVALUE CHAR(250) )" + Chr(13)+Chr(10)
   cTable         += "IN DATABASE;" + Chr(13)+Chr(10)

   dbSelectArea( 0 )

   if ADSCreateSQLStatement( "ColumnLog", 3 )

      lTrigger    := ADSExecuteSQLDirect( cTable )
      if !lTrigger
         nError   := AdsGetLastError( @cErrorAds )
         msgStop( cErrorAds + Chr(13)+Chr(10) + cTable, "ERROR CREATE TABLE en ADSExecuteSQLDirect" )
      endif

   else

      nError      := AdsGetLastError( @cErrorAds )
      msgStop( cErrorAds + Chr(13)+Chr(10) + cTable, "ERROR CREATE TABLE en ADSCreateSQLStatement" )

   end

   AdsCacheOpenCursors( 0 )
   AdsClrCallBack()

Return ( Self )



UTILITY STATIC function TDataCenter_Auditor() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   if !::lSelectAuditor()
      Return ( Self )
   end

   ::lCreaArrayPeriodos()

   ::oDlgAuditor = TDialog():New(,,,,, "AdsAuditor",, .F.,,,,,, .F.,,,,,, .F., )





      ::oPeriodo := TComboBox():ReDefine( 110, { | u | If( PCount()==0, ::cPeriodo, ::cPeriodo:= u ) }, ::aPeriodo, ::oDlgAuditor,,,,,,, .F.,,,,,, )

      ::oPeriodo:bChange                     := {|| ::lRecargaFecha() }





      ::oIniInf := TGetHlp():ReDefine( 120, { | u | If( PCount()==0, ::dIniInf, ::dIniInf:= u ) }, ::oDlgAuditor,,,,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





      ::oFinInf := TGetHlp():ReDefine( 130, { | u | If( PCount()==0, ::dFinInf, ::dFinInf:= u ) }, ::oDlgAuditor,,,,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )



      TCheckBox():ReDefine( 140, { | u | If( PCount()==0, ::lAppend, ::lAppend:= u ) }, ::oDlgAuditor,,,,,,, .F.,, .F. )



      TCheckBox():ReDefine( 141, { | u | If( PCount()==0, ::lEdit, ::lEdit:= u ) }, ::oDlgAuditor,,,,,,, .F.,, .F. )



      TCheckBox():ReDefine( 142, { | u | If( PCount()==0, ::lDelete, ::lDelete:= u ) }, ::oDlgAuditor,,,,,,, .F.,, .F. )




      TButton():ReDefine( 150, {||( ::lSelectAuditor() )}, ::oDlgAuditor,,, .F.,,,, .F. )

      ::oBrwOperation                        := IXBrowse():New( ::oDlgAuditor )

      ::oBrwOperation:lRecordSelector        := .T.
      ::oBrwOperation:lTransparent           := .F.
      ::oBrwOperation:nDataLines             := 1

      ::oBrwOperation:lVScroll               := .T.
      ::oBrwOperation:lHScroll               := .F.

      ::oBrwOperation:nMarqueeStyle          := 5

      ::oBrwOperation:cAlias                 := "SqlOperation"

      ::oBrwOperation:bClrSel                := {|| { 16777215, ( 53 + ( 142 * 256 ) + ( 182 * 65536 ) ) } }
      ::oBrwOperation:bClrSelFocus           := {|| { 16777215, ( 53 + ( 142 * 256 ) + ( 182 * 65536 ) ) } }

      ::oBrwOperation:CreateFromResource( 200 )

      with object ( ::oBrwOperation:AddCol() )
         :cHeader          := "Id"
         :nWidth           := 80
         :bEditValue       := {|| SqlOperation->Id }
      end

      with object ( ::oBrwOperation:AddCol() )
         :cHeader          := "Fecha y hora"
         :nWidth           := 140
         :cDataType        := "T"
         :cEditPicture     := "@T"
         :nDataStrAlign    := 3
         :nHeadStrAlign    := 3
         :bEditValue       := {|| SqlOperation->DateTime }
      end

      with object ( ::oBrwOperation:AddCol() )
         :cHeader          := "Usuario"
         :nWidth           := 100
         :bEditValue       := {|| SqlOperation->UserName }
      end

      with object ( ::oBrwOperation:AddCol() )
         :cHeader          := "Aplicación"
         :nWidth           := 100
         :bEditValue       := {|| SqlOperation->AppName }
      end

      with object ( ::oBrwOperation:AddCol() )
         :cHeader          := "Tabla"
         :nWidth           := 100
         :bEditValue       := {|| ::cTableDescription( SqlOperation->TableName ) }
      end

      with object ( ::oBrwOperation:AddCol() )
         :cHeader          := "Operación"
         :nWidth           := 100
         :bEditValue       := {|| SqlOperation->Operation }
      end




      TButton():ReDefine( 1, {||( ::oDlgAuditor:End() )}, ::oDlgAuditor,,, .F.,,,, .F. )

   ::oDlgAuditor:Activate( , , , .T., {|| ::lValidAuditor() } )

RETURN ( Self )



UTILITY STATIC function TDataCenter_lSelectAuditor() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local lOk
   local cStm
   local cOpe
   local nError
   local cErrorAds





   cStm           := "SELECT * FROM SqlOperationLog "
   cStm           += "WHERE DateTime >= '" + Dtoc( ::dIniInf ) + " 00:00:00' AND DateTime <= '" + Dtoc( ::dFinInf ) + " 23:59:59' "

   cOpe           := ""

   if ::lAppend
      cOpe        += "Operation = 'INSERT'"
   end

   if ::lEdit
      cOpe        += if( !Empty( cOpe ), " OR ", "" )
      cOpe        += "Operation = 'UPDATE'"
   end

   if ::lDelete
      cOpe        += if( !Empty( cOpe ), " OR ", "" )
      cOpe        += "Operation = 'DELETE'"
   end

   if !Empty( cOpe )
      cStm        += " AND ( " + cOpe + " )"
   end





   ::lValidAuditor()





   if ADSCreateSQLStatement( "SqlOperation", 3 )

      lOk         := ADSExecuteSQLDirect( cStm )
      if !lOk
         nError   := AdsGetLastError( @cErrorAds )
         msgStop( cErrorAds, "ERROR en ADSSqlOperationLog" )
      endif

   else

      nError      := AdsGetLastError( @cErrorAds )
      msgStop( cErrorAds, "ERROR en ADSCreateSQLStatement" )

   end

   AdsCacheOpenCursors( 0 )
   AdsClrCallBack()





   if !Empty( ::oBrwOperation )
      ::oBrwOperation:Refresh()
   end

RETURN ( lOk )



UTILITY STATIC function TDataCenter_lCreaArrayPeriodos() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   aAdd( ::aPeriodo, "Hoy" )

   aAdd( ::aPeriodo, "Ayer" )

   aAdd( ::aPeriodo, "Mes en curso" )

   aAdd( ::aPeriodo, "Mes anterior" )

   do case
      case Month( GetSysDate() ) <= 3
         aAdd( ::aPeriodo, "Primer trimestre" )

      case Month( GetSysDate() ) > 3 .AND. Month( GetSysDate() ) <= 6
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )

      case Month( GetSysDate() ) > 6 .AND. Month( GetSysDate() ) <= 9
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )
         aAdd( ::aPeriodo, "Tercer trimestre" )

      case Month( GetSysDate() ) > 9 .AND. Month( GetSysDate() ) <= 12
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )
         aAdd( ::aPeriodo, "Tercer trimestre" )
         aAdd( ::aPeriodo, "Cuatro trimestre" )

   end

   aAdd( ::aPeriodo, "Doce últimos meses" )

   aAdd( ::aPeriodo, "Año en curso" )

   aAdd( ::aPeriodo, "Año anterior" )

RETURN ( Self )



UTILITY STATIC function TDataCenter_lRecargaFecha() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   do case
      case ::cPeriodo == "Hoy"

         ::oIniInf:cText( GetSysDate() )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Ayer"

         ::oIniInf:cText( GetSysDate() -1 )
         ::oFinInf:cText( GetSysDate() -1 )

      case ::cPeriodo == "Mes en curso"

         ::oIniInf:cText( CtoD( "01/" + Str( Month( GetSysDate() ) ) + "/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Mes anterior"

         ::oIniInf:cText( CtoD( "01/" + Str( Month( GetSysDate() ) - 1 ) + "/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( nLastDay( Month( GetSysDate() ) - 1 ) )

      case ::cPeriodo == "Primer trimestre"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/03/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Segundo trimestre"

         ::oIniInf:cText( CtoD( "01/04/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "30/06/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Tercer trimestre"

         ::oIniInf:cText( CtoD( "01/07/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "30/09/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Cuatro trimestre"

         ::oIniInf:cText( CtoD( "01/10/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Doce últimos meses"

         ::oIniInf:cText( CtoD( Str( Day( GetSysDate() ) ) + "/" + Str( Month( GetSysDate() ) ) + "/" + Str( Year( GetSysDate() ) -1 ) ) )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Año en curso"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Año anterior"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) - 1 ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) - 1 ) ) )

   end

RETURN ( .T. )



UTILITY STATIC function TDataCenter_lValidAuditor() ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   ( "SqlOperationLog" )->( dbCloseArea() )

   dbSelectArea( 0 )

   dbCloseAll()

RETURN ( .T. )



UTILITY STATIC function TDataCenter_cTableDescription( cTableName) ; local Self AS CLASS TDataCenter := QSelf() AS CLASS TDataCenter

   local nScan
   local cDescription   := cTableName

   nScan                := aScan( ::aDataTables, {|o| Alltrim( o:cName ) $ Alltrim( cTableName ) } )
   if nScan <> 0
      cDescription      := ::aDataTables[ nScan ]:cDescription
   end

Return ( cDescription )






_HB_CLASS TDataTable ; UTILITY FUNCTION TDataTable(...); static s_oClass ; local oClassInstance ; local nScope ; nScope := 1 ; if s_oClass == NIL ; s_oClass := IIF(.F.,, HBClass():New( "TDataTable" , { HBObject():Classh } ) ) ;

   _HB_MEMBER { cName} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "cName" }, .F., .F. ), )
   _HB_MEMBER { cDataFile} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "cDataFile" }, .F., .F. ), )
   _HB_MEMBER { cIndexFile} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "cIndexFile" }, .F., .F. ), )
   _HB_MEMBER { cDescription} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cDescription" }, .F., .F. ), )
   _HB_MEMBER { aFields} ; IIF( !.F., s_oClass:AddMultiData(, {}, nScope + IIF( .F., 32, 0 ), { "aFields" }, .F., .F. ), )
   _HB_MEMBER { lTrigger} ; IIF( !.F., s_oClass:AddMultiData(, .T., nScope + IIF( .F., 32, 0 ), { "lTrigger" }, .F., .F. ), )

; IF .F. ; __clsActive(s_oClass:hClass) ; s_oClass:Refresh() ; ELSE ; s_oClass:Create() ; END ; oClassInstance := __clsInst( s_oClass:hClass ) ; IF __ObjHasMsg( oClassInstance, "InitClass" ); oClassInstance:InitClass( hb_aParams() ) ; END ; ELSE ; oClassInstance := __clsInst( s_oClass:hClass ) ; END ; IF PCount() > 0 ; DIVERT TO (@DivertConstructorCall()) OF s_oClass ; END ; RETURN oClassInstance AS CLASS TDataTable ;







_HB_CLASS TDataUser ; UTILITY FUNCTION TDataUser(...); static s_oClass ; local oClassInstance ; local nScope ; nScope := 1 ; if s_oClass == NIL ; s_oClass := IIF(.F.,, HBClass():New( "TDataUser" , { HBObject():Classh } ) ) ;

   _HB_MEMBER { cName} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cName" }, .F., .F. ), )
   _HB_MEMBER { cPassword} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cPassword" }, .F., .F. ), )
   _HB_MEMBER { cComment} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cComment" }, .F., .F. ), )

; IF .F. ; __clsActive(s_oClass:hClass) ; s_oClass:Refresh() ; ELSE ; s_oClass:Create() ; END ; oClassInstance := __clsInst( s_oClass:hClass ) ; IF __ObjHasMsg( oClassInstance, "InitClass" ); oClassInstance:InitClass( hb_aParams() ) ; END ; ELSE ; oClassInstance := __clsInst( s_oClass:hClass ) ; END ; IF PCount() > 0 ; DIVERT TO (@DivertConstructorCall()) OF s_oClass ; END ; RETURN oClassInstance AS CLASS TDataUser ;







Function ApoloDDAddTable( cTableName, cTableDatabase, cTableIndex )

   local nError
   local cError
   local lAddTable   := .T.

   if !AdsExistTable( cTableName )
      if !AdsDDaddTable( cTableName, cTableDatabase, cTableIndex )
         lAddTable   := .F.
         msgInfo( "Error adding table : " + cValToChar( adsGetLastError( @cError ) ), cError )
      end
   end

Return ( lAddTable )



Function AdsExistTable( cTable )

   local aAdsTables

   if Empty( aAdsTables )
      aAdsTables  := AdsDirectory()
   end

Return ( aScan( aAdsTables, {|c| Left( Upper( c ), len( c ) - 1 ) == Upper( cTable ) } ) <> 0 )



Function ADSSelectSQLScript( cScript )

   local i
   local aData             := {}
   local cArea
   local lGood             := .F.

   if !Empty( cScript )

      AdsCacheOpenCursors( 0 )
      dbSelectArea( 0 )

      if !ADSCreateSQLStatement( "SQLArea", 2 )

         SQLArea->( dbCloseArea() )

         MsgStop( "AdsCreateSqlStatement() failed with error "+ cValToChar( ADSGetLastError() ) )

      else

         lGood             := ADSExecuteSQLDirect( cScript )

      endif

      if lGood

         CursorWait()

         while !( SQLArea->( eof() ) )

            if !Empty( SQLArea->( fieldGet( 1 ) ) )
               aAdd( aData, SQLArea->( fieldGet( 1 ) ) )
            end

            SQLArea->( dbSkip() )

         end

         CursorWE()

         AdsCacheOpenCursors( 0 )
         AdsClrCallBack()

         if SQLArea->( Used() )
            SQLArea->( dbCloseArea() )
         endif

      end

   end

Return ( aData )



Function ADSExecuteSQLScript( cScript )

   local i
   local aData             := {}
   local cArea
   local lGood             := .F.

   if !Empty( cScript )

      AdsCacheOpenCursors( 0 )
      dbSelectArea( 0 )

      if !ADSCreateSQLStatement( "SQLArea", 3 )

         SQLArea->( dbCloseArea() )

         MsgStop( "AdsCreateSqlStatement() failed with error "+ cValToChar( ADSGetLastError() ) )

      else

         lGood             := ADSExecuteSQLDirect( cScript )

      endif

      if !lGood

         MsgStop( "ADSExecuteSQLDirect() failed with error "+ cValToChar( ADSGetLastError() ) )

      end




         AdsCacheOpenCursors( 0 )
         AdsClrCallBack()

         if SQLArea->( Used() )
            SQLArea->( dbCloseArea() )
         endif



   end

Return ( aData )
