#line 112 "hbclass.ch"
   DYNAMIC DivertConstructorCall
















DECLARE HBClass  New( cName AS String, OPTIONAL SuperParams ) AS CLASS HBClass  Create() AS Object  Instance() AS Object  AddClsMethod( cName AS String, @MethodName(), nScope AS Numeric, n2 AS Numeric, n3 AS Numeric )  AddDelegate( cName AS String, cDelegate AS String, cObject AS String, nScope AS Numeric, lPersistent AS LOGICAL )  AddMultiClsData( cType AS String, uVal, nScope AS Numeric, aDatas AS Array OF String )  AddMultiData( cType AS String, uVal, nScope AS Numeric, aDatas AS Array OF String, x AS LOGICAL, lPer AS LOGICAL )  AddMethod( cName AS String, @MethodName(), nScope AS Numeric, lPersistent AS LOGICAL )  AddInLine( cName AS String, bBlock AS CodeBlock, nScope AS Numeric, lPersistent AS LOGICAL )  AddVirtual( cName AS String )  ModMethod( cName AS String, @MethodName(), nScope AS Numeric, lPersistent AS LOGICAL )  ModClsMethod( cName AS String, @MethodName(), nScope AS Numeric )  ModInline( cName AS String, bBlock AS CodeBlock, nScope AS Numeric, lPersistent AS LOGICAL )  SetOnError( @MethodName() )
#line 85 "\Fwh1204\Include\FiveWin.Ch"
   EXTERNAL GetProcAdd
   EXTERNAL TActiveX




extern errorsys
#line 7 ".\Prg\TNewInfGen.prg"
memvar dFechaInicio
memvar dFechaFin
memvar cGrupoFabricanteDesde
memvar cGrupoFabricanteHasta
memvar cGrupoArticuloDesde
memvar cGrupoArticuloHasta
memvar cGrupoClienteDesde
memvar cGrupoClienteHasta
memvar cGrupoRutaDesde
memvar cGrupoRutaHasta
memvar cGrupoAgenteDesde
memvar cGrupoAgenteHasta



_HB_CLASS TNewInfGen ; UTILITY FUNCTION TNewInfGen(...); static s_oClass ; local oClassInstance ; local nScope ; nScope := 1 ; if s_oClass == NIL ; s_oClass := IIF(.F.,, HBClass():New( "TNewInfGen" , {TInfGen():classh} ) ) ; ;

   _HB_MEMBER { lDefEstadoUno} ; IIF( !.F., s_oClass:AddMultiData(, .F., nScope + IIF( .F., 32, 0 ), { "lDefEstadoUno" }, .F., .F. ), )
   _HB_MEMBER { oEstadoUno} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oEstadoUno" }, .F., .F. ), )
   _HB_MEMBER { cEstadoUno} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cEstadoUno" }, .F., .F. ), )
   _HB_MEMBER { aEstadoUno} ; IIF( !.F., s_oClass:AddMultiData(, {}, nScope + IIF( .F., 32, 0 ), { "aEstadoUno" }, .F., .F. ), )

   _HB_MEMBER { lDefEstadoDos} ; IIF( !.F., s_oClass:AddMultiData(, .F., nScope + IIF( .F., 32, 0 ), { "lDefEstadoDos" }, .F., .F. ), )
   _HB_MEMBER { oEstadoDos} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oEstadoDos" }, .F., .F. ), )
   _HB_MEMBER { cEstadoDos} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cEstadoDos" }, .F., .F. ), )
   _HB_MEMBER { aEstadoDos} ; IIF( !.F., s_oClass:AddMultiData(, {}, nScope + IIF( .F., 32, 0 ), { "aEstadoDos" }, .F., .F. ), )

   _HB_MEMBER { lDefCondiciones} ; IIF( !.F., s_oClass:AddMultiData(, .T., nScope + IIF( .F., 32, 0 ), { "lDefCondiciones" }, .F., .F. ), )
   _HB_MEMBER { oGrupoCondiciones} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoCondiciones" }, .F., .F. ), )
   _HB_MEMBER { oTreeCondiciones} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oTreeCondiciones" }, .F., .F. ), )

   _HB_MEMBER { oTreeRango} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oTreeRango" }, .F., .F. ), )
   _HB_MEMBER { oImageList} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oImageList" }, .F., .F. ), )

   _HB_MEMBER { oDesde} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oDesde" }, .F., .F. ), )
   _HB_MEMBER { cDesde} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cDesde" }, .F., .F. ), )
   _HB_MEMBER { oSayDesde} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oSayDesde" }, .F., .F. ), )
   _HB_MEMBER { cSayDesde} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cSayDesde" }, .F., .F. ), )

   _HB_MEMBER { oHasta} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oHasta" }, .F., .F. ), )
   _HB_MEMBER { cHasta} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cHasta" }, .F., .F. ), )
   _HB_MEMBER { oSayHasta} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oSayHasta" }, .F., .F. ), )
   _HB_MEMBER { cSayHasta} ; IIF( !.F., s_oClass:AddMultiData(, "", nScope + IIF( .F., 32, 0 ), { "cSayHasta" }, .F., .F. ), )

   _HB_MEMBER { oTodos} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oTodos" }, .F., .F. ), )
   _HB_MEMBER { lTodos} ; IIF( !.F., s_oClass:AddMultiData(, .T., nScope + IIF( .F., 32, 0 ), { "lTodos" }, .F., .F. ), )

   _HB_MEMBER { oDesglosar} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oDesglosar" }, .F., .F. ), )
   _HB_MEMBER { lDesglosar} ; IIF( !.F., s_oClass:AddMultiData(, .F., nScope + IIF( .F., 32, 0 ), { "lDesglosar" }, .F., .F. ), )
   _HB_MEMBER { oLinImporteCero} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oLinImporteCero" }, .F., .F. ), )
   _HB_MEMBER { lLinImporteCero} ; IIF( !.F., s_oClass:AddMultiData(, .F., nScope + IIF( .F., 32, 0 ), { "lLinImporteCero" }, .F., .F. ), )
   _HB_MEMBER { oDocImporteCero} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oDocImporteCero" }, .F., .F. ), )
   _HB_MEMBER { lDocImporteCero} ; IIF( !.F., s_oClass:AddMultiData(, .F., nScope + IIF( .F., 32, 0 ), { "lDocImporteCero" }, .F., .F. ), )

   _HB_MEMBER { oTipOpera} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oTipOpera" }, .F., .F. ), )

   _HB_MEMBER { oGrupoArticulo} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoArticulo" }, .F., .F. ), )
   _HB_MEMBER { oGrupoCliente} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoCliente" }, .F., .F. ), )
   _HB_MEMBER { oGrupoProveedor} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoProveedor" }, .F., .F. ), )
   _HB_MEMBER { oGrupoOperacion} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoOperacion" }, .F., .F. ), )
   _HB_MEMBER { oGrupoSeccion} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoSeccion" }, .F., .F. ), )
   _HB_MEMBER { oGrupoAlmacen} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoAlmacen" }, .F., .F. ), )
   _HB_MEMBER { oGrupoMaquina} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoMaquina" }, .F., .F. ), )
   _HB_MEMBER { oGrupoOperario} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoOperario" }, .F., .F. ), )
   _HB_MEMBER { oGrupoFpago} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoFpago" }, .F., .F. ), )
   _HB_MEMBER { oGrupoBanco} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoBanco" }, .F., .F. ), )
   _HB_MEMBER { oGrupoAgente} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoAgente" }, .F., .F. ), )
   _HB_MEMBER { oGrupoUsuario} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoUsuario" }, .F., .F. ), )
   _HB_MEMBER { oGrupoCaja} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoCaja" }, .F., .F. ), )
   _HB_MEMBER { oGrupoTransportista} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoTransportista" }, .F., .F. ), )
   _HB_MEMBER { oGrupoGCliente} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoGCliente" }, .F., .F. ), )
   _HB_MEMBER { oGrupoGProveedor} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoGProveedor" }, .F., .F. ), )
   _HB_MEMBER { oGrupoObra} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoObra" }, .F., .F. ), )
   _HB_MEMBER { oGrupoFamilia} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoFamilia" }, .F., .F. ), )
   _HB_MEMBER { oGrupoGFamilia} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoGFamilia" }, .F., .F. ), )
   _HB_MEMBER { oGrupoTArticulo} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoTArticulo" }, .F., .F. ), )
   _HB_MEMBER { oGrupoFabricante} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoFabricante" }, .F., .F. ), )
   _HB_MEMBER { oGrupoTOperacion} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoTOperacion" }, .F., .F. ), )
   _HB_MEMBER { oGrupoCategoria} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoCategoria" }, .F., .F. ), )
   _HB_MEMBER { oGrupoRuta} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoRuta" }, .F., .F. ), )
   _HB_MEMBER { oGrupoFacturas} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoFacturas" }, .F., .F. ), )
   _HB_MEMBER { oGrupoFacturasCompras} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoFacturasCompras" }, .F., .F. ), )
   _HB_MEMBER { oGrupoTemporada} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoTemporada" }, .F., .F. ), )
   _HB_MEMBER { oGrupoIVA} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoIVA" }, .F., .F. ), )
   _HB_MEMBER { oGrupoSerie} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoSerie" }, .F., .F. ), )

   _HB_MEMBER { oTipoExpediente} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oTipoExpediente" }, .F., .F. ), )
   _HB_MEMBER { oGrupoTipoExpediente} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoTipoExpediente" }, .F., .F. ), )

   _HB_MEMBER { oEntidad} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oEntidad" }, .F., .F. ), )
   _HB_MEMBER { oGrupoEntidad} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoEntidad" }, .F., .F. ), )

   _HB_MEMBER { oColaborador} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oColaborador" }, .F., .F. ), )
   _HB_MEMBER { oGrupoColaborador} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoColaborador" }, .F., .F. ), )

   _HB_MEMBER { oCuentasBancarias} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oCuentasBancarias" }, .F., .F. ), )
   _HB_MEMBER { oGrupoCuentasBancarias} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oGrupoCuentasBancarias" }, .F., .F. ), )

   _HB_MEMBER { oColNombre} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oColNombre" }, .F., .F. ), )

   _HB_MEMBER { oFastReport} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oFastReport" }, .F., .F. ), )

   _HB_MEMBER { oPeriodo} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oPeriodo" }, .F., .F. ), )
   _HB_MEMBER { cPeriodo} ; IIF( !.F., s_oClass:AddMultiData(, "Mes en curso", nScope + IIF( .F., 32, 0 ), { "cPeriodo" }, .F., .F. ), )
   _HB_MEMBER { aPeriodo} ; IIF( !.F., s_oClass:AddMultiData(, {}, nScope + IIF( .F., 32, 0 ), { "aPeriodo" }, .F., .F. ), )

   _HB_MEMBER { oFacCliT} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oFacCliT" }, .F., .F. ), )
   _HB_MEMBER { oFacPrvT} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oFacPrvT" }, .F., .F. ), )

   _HB_MEMBER { oHoraInicio} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oHoraInicio" }, .F., .F. ), )
   _HB_MEMBER { cHoraInicio} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "cHoraInicio" }, .F., .F. ), )
   _HB_MEMBER { oHoraFin} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "oHoraFin" }, .F., .F. ), )
   _HB_MEMBER { cHoraFin} ; IIF( !.F., s_oClass:AddMultiData(,, nScope + IIF( .F., 32, 0 ), { "cHoraFin" }, .F., .F. ), )

   _HB_MEMBER NewResource(); IIF( .F., s_oClass:ModMethod( "NewResource", @TNewInfGen_NewResource(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "NewResource", @TNewInfGen_NewResource(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoArticulo( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoArticulo", @TNewInfGen_lGrupoArticulo(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoArticulo", @TNewInfGen_lGrupoArticulo(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoCliente( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoCliente", @TNewInfGen_lGrupoCliente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoCliente", @TNewInfGen_lGrupoCliente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoOperacion( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoOperacion", @TNewInfGen_lGrupoOperacion(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoOperacion", @TNewInfGen_lGrupoOperacion(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoSeccion( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoSeccion", @TNewInfGen_lGrupoSeccion(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoSeccion", @TNewInfGen_lGrupoSeccion(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoAlmacen( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoAlmacen", @TNewInfGen_lGrupoAlmacen(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoAlmacen", @TNewInfGen_lGrupoAlmacen(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoMaquina( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoMaquina", @TNewInfGen_lGrupoMaquina(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoMaquina", @TNewInfGen_lGrupoMaquina(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoOperario( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoOperario", @TNewInfGen_lGrupoOperario(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoOperario", @TNewInfGen_lGrupoOperario(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoFPago( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoFPago", @TNewInfGen_lGrupoFPago(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoFPago", @TNewInfGen_lGrupoFPago(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoBanco( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoBanco", @TNewInfGen_lGrupoBanco(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoBanco", @TNewInfGen_lGrupoBanco(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoAgente( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoAgente", @TNewInfGen_lGrupoAgente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoAgente", @TNewInfGen_lGrupoAgente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoUsuario( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoUsuario", @TNewInfGen_lGrupoUsuario(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoUsuario", @TNewInfGen_lGrupoUsuario(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoCaja( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoCaja", @TNewInfGen_lGrupoCaja(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoCaja", @TNewInfGen_lGrupoCaja(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoTransportista( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoTransportista", @TNewInfGen_lGrupoTransportista(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoTransportista", @TNewInfGen_lGrupoTransportista(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoGCliente( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoGCliente", @TNewInfGen_lGrupoGCliente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoGCliente", @TNewInfGen_lGrupoGCliente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoGProveedor( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoGProveedor", @TNewInfGen_lGrupoGProveedor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoGProveedor", @TNewInfGen_lGrupoGProveedor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoObra( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoObra", @TNewInfGen_lGrupoObra(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoObra", @TNewInfGen_lGrupoObra(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoFamilia( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoFamilia", @TNewInfGen_lGrupoFamilia(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoFamilia", @TNewInfGen_lGrupoFamilia(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoGFamilia( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoGFamilia", @TNewInfGen_lGrupoGFamilia(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoGFamilia", @TNewInfGen_lGrupoGFamilia(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoTipoArticulo( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoTipoArticulo", @TNewInfGen_lGrupoTipoArticulo(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoTipoArticulo", @TNewInfGen_lGrupoTipoArticulo(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoFabricante( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoFabricante", @TNewInfGen_lGrupoFabricante(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoFabricante", @TNewInfGen_lGrupoFabricante(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoTOperacion( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoTOperacion", @TNewInfGen_lGrupoTOperacion(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoTOperacion", @TNewInfGen_lGrupoTOperacion(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoProveedor( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoProveedor", @TNewInfGen_lGrupoProveedor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoProveedor", @TNewInfGen_lGrupoProveedor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoTipoExpediente( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoTipoExpediente", @TNewInfGen_lGrupoTipoExpediente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoTipoExpediente", @TNewInfGen_lGrupoTipoExpediente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoEntidad( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoEntidad", @TNewInfGen_lGrupoEntidad(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoEntidad", @TNewInfGen_lGrupoEntidad(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoColaborador( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoColaborador", @TNewInfGen_lGrupoColaborador(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoColaborador", @TNewInfGen_lGrupoColaborador(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoCategoria( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoCategoria", @TNewInfGen_lGrupoCategoria(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoCategoria", @TNewInfGen_lGrupoCategoria(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoRuta( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoRuta", @TNewInfGen_lGrupoRuta(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoRuta", @TNewInfGen_lGrupoRuta(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoFacturas( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoFacturas", @TNewInfGen_lGrupoFacturas(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoFacturas", @TNewInfGen_lGrupoFacturas(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoFacturasCompras( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoFacturasCompras", @TNewInfGen_lGrupoFacturasCompras(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoFacturasCompras", @TNewInfGen_lGrupoFacturasCompras(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoTemporada( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoTemporada", @TNewInfGen_lGrupoTemporada(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoTemporada", @TNewInfGen_lGrupoTemporada(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoIva( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoIva", @TNewInfGen_lGrupoIva(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoIva", @TNewInfGen_lGrupoIva(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoEntidadesBancarias( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoEntidadesBancarias", @TNewInfGen_lGrupoEntidadesBancarias(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoEntidadesBancarias", @TNewInfGen_lGrupoEntidadesBancarias(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lGrupoSerie( lInitGroup, lImp); IIF( .F., s_oClass:ModMethod( "lGrupoSerie", @TNewInfGen_lGrupoSerie(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lGrupoSerie", @TNewInfGen_lGrupoSerie(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER oDefEstados( nIdEstadoUno, nIdEstadoDos); IIF( .F., s_oClass:ModMethod( "oDefEstados", @TNewInfGen_oDefEstados(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefEstados", @TNewInfGen_oDefEstados(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER oDefDesde( nIdDesde, nIdSayDesde); IIF( .F., s_oClass:ModMethod( "oDefDesde", @TNewInfGen_oDefDesde(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefDesde", @TNewInfGen_oDefDesde(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER oDefHasta( nIdHasta, nIdSayHasta); IIF( .F., s_oClass:ModMethod( "oDefHasta", @TNewInfGen_oDefHasta(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefHasta", @TNewInfGen_oDefHasta(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER oDefTodos( nIdTodos); IIF( .F., s_oClass:ModMethod( "oDefTodos", @TNewInfGen_oDefTodos(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefTodos", @TNewInfGen_oDefTodos(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER HideCondiciones(); IIF( .F., s_oClass:ModMethod( "HideCondiciones", @TNewInfGen_HideCondiciones(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "HideCondiciones", @TNewInfGen_HideCondiciones(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER ChangeRango(); IIF( .F., s_oClass:ModMethod( "ChangeRango", @TNewInfGen_ChangeRango(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "ChangeRango", @TNewInfGen_ChangeRango(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER ChangeValor(); IIF( .F., s_oClass:ModMethod( "ChangeValor", @TNewInfGen_ChangeValor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "ChangeValor", @TNewInfGen_ChangeValor(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER InitDialog(); IIF( .F., s_oClass:ModMethod( "InitDialog", @TNewInfGen_InitDialog(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "InitDialog", @TNewInfGen_InitDialog(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER oDefDesglosar(); IIF( .F., s_oClass:ModMethod( "oDefDesglosar", @TNewInfGen_oDefDesglosar(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefDesglosar", @TNewInfGen_oDefDesglosar(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER oDefLinImporteCero(); IIF( .F., s_oClass:ModMethod( "oDefLinImporteCero", @TNewInfGen_oDefLinImporteCero(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefLinImporteCero", @TNewInfGen_oDefLinImporteCero(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER oDefDocImporteCero(); IIF( .F., s_oClass:ModMethod( "oDefDocImporteCero", @TNewInfGen_oDefDocImporteCero(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefDocImporteCero", @TNewInfGen_oDefDocImporteCero(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lIgualCliente(); IIF( .F., s_oClass:ModMethod( "lIgualCliente", @TNewInfGen_lIgualCliente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lIgualCliente", @TNewInfGen_lIgualCliente(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lPeriodoInforme( nId, oDlg); IIF( .F., s_oClass:ModMethod( "lPeriodoInforme", @TNewInfGen_lPeriodoInforme(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lPeriodoInforme", @TNewInfGen_lPeriodoInforme(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lRecargaFecha(); IIF( .F., s_oClass:ModMethod( "lRecargaFecha", @TNewInfGen_lRecargaFecha(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lRecargaFecha", @TNewInfGen_lRecargaFecha(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER lHideFecha(); IIF( .F., s_oClass:ModMethod( "lHideFecha", @TNewInfGen_lHideFecha(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lHideFecha", @TNewInfGen_lHideFecha(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));
   _HB_MEMBER lShowFecha(); IIF( .F., s_oClass:ModMethod( "lShowFecha", @TNewInfGen_lShowFecha(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lShowFecha", @TNewInfGen_lShowFecha(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER lCreaArrayPeriodos(); IIF( .F., s_oClass:ModMethod( "lCreaArrayPeriodos", @TNewInfGen_lCreaArrayPeriodos(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "lCreaArrayPeriodos", @TNewInfGen_lCreaArrayPeriodos(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER FastReport( ); IIF( !.F., s_oClass:AddVirtual( "FastReport" ), )

   _HB_MEMBER DataReport( ); IIF( !.F., s_oClass:AddVirtual( "DataReport" ), )

   _HB_MEMBER oDefHoraInicio( nId, oDlg); IIF( .F., s_oClass:ModMethod( "oDefHoraInicio", @TNewInfGen_oDefHoraInicio(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefHoraInicio", @TNewInfGen_oDefHoraInicio(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER oDefHoraFin( nId, oDlg); IIF( .F., s_oClass:ModMethod( "oDefHoraFin", @TNewInfGen_oDefHoraFin(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "oDefHoraFin", @TNewInfGen_oDefHoraFin(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER AddVariable(); IIF( .F., s_oClass:ModMethod( "AddVariable", @TNewInfGen_AddVariable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "AddVariable", @TNewInfGen_AddVariable(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER SaveReport(); IIF( .F., s_oClass:ModMethod( "SaveReport", @TNewInfGen_SaveReport(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "SaveReport", @TNewInfGen_SaveReport(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

   _HB_MEMBER MoveReport(); IIF( .F., s_oClass:ModMethod( "MoveReport", @TNewInfGen_MoveReport(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ), s_oClass:AddMethod( "MoveReport", @TNewInfGen_MoveReport(), nScope + IIF( .F., 16, 0 ) + IIF( .F., 1024, 0 ), .F. ));

; IF .F. ; __clsActive(s_oClass:hClass) ; s_oClass:Refresh() ; ELSE ; s_oClass:Create() ; END ; oClassInstance := __clsInst( s_oClass:hClass ) ; IF __ObjHasMsg( oClassInstance, "InitClass" ); oClassInstance:InitClass( hb_aParams() ) ; END ; ELSE ; oClassInstance := __clsInst( s_oClass:hClass ) ; END ; IF PCount() > 0 ; DIVERT TO (@DivertConstructorCall()) OF s_oClass ; END ; RETURN oClassInstance AS CLASS TNewInfGen ;



UTILITY STATIC function TNewInfGen_NewResource( cFldRes) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local n
   local oCellView
   local oImagen
   local oShadow
   local aoFont      := { , , }
   local aoSizes     := { , , }
   local aoEstilo    := { , , }
   local aSizes      := { "8", "10", "12", "14", "16", "18", "20", "22", "24", "26", "28", "36", "48", "72" }
   local aEstilo     := { "Normal", "Cursiva", "Negrita", "Negrita Cursiva" }
   local aPad        := { "Izquierda", "Derecha" }
   local oPrinter

   IIF( cFldRes == nil, cFldRes := "INF_GEN_01", ) ;





   if !::OpenData()
      Return .F.
   end





   ::oDbf:Activate( .F., .F. )





   for n := 1 to len( ::aIndex )











      ::oDbf:AddTmpIndex(  ::aIndex[n,1], ::cFileIndx, ::aIndex[n,2], ::aIndex[n,3], ::aIndex[n,4], ::aIndex[n,5], ::aIndex[n,6], , , , , .T. )
   next





   ::lCreaArrayPeriodos()





   if !::lBig
      ::oDlg = TDialog():New(,,,, ::cSubTitle, "INF_GEN",, .F.,,,,,, .F.,,,,,, .F., )
   else
      ::oDlg = TDialog():New(,,,, ::cSubTitle, "INF_GENBIG",, .F.,,,,,, .F.,,,,,, .F., )
   end






   if !::lNewInforme
      ::oFld := TFolder():ReDefine( 400, {"I&nforme", "&Columnas", "A&pariencia" }, { cFldRes, "INF_GEN_COL", "INF_GEN_PRN" }, ::oDlg )
   else
      ::oFld := TFolder():ReDefine( 400, {"I&nforme", "A&grupar...", "&Columnas", "A&pariencia" }, { cFldRes, "INF_GEN_AGRUPA", "INF_GEN_COL", "INF_GEN_PRN" }, ::oDlg )
   end





   ::CreateColumn()





   ::Default()





   ::oImageList            := TImageList():New( 16, 16 )
   ::oImageGroup           := TImageList():New( 16, 16 )





   if ::lDefDesHas
      ::oDefDesHas()
   end





   if ::lDefFecInf
      ::oDefIniInf()
      ::oDefFinInf()
      ::lPeriodoInforme()
   end





   ::oDefEstados()





   ::oTreeRango                     := TTreeView():Redefine( 100, ::oFld:aDialogs[1] )
   ::oTreeRango:bChanged            := {|| ::ChangeRango() }
   ::oTreeRango:bLostFocus          := {|| ::ChangeValor() }





   ::oDefTodos()
   ::oDefDesde()
   ::oDefHasta()





   ::oGrupoCondiciones := TGroup():ReDefine( 131,, ::oFld:aDialogs[ 1 ],,,, .T. )

   ::oTreeCondiciones               := TTreeView():Redefine( 130, ::oFld:aDialogs[1] )





   if ::lDefDivInf
      ::oDefDivInf()
   end





   if ::lDefTitInf
      ::oDefTitInf()
   end





   if ::lDefMetInf
      ::oDefMetInf()
   end





   if ::lDefSerInf
      ::oDefSerInf()
   end





   if ::lNewInforme

   ::oTreeGroups           := TTreeView():Redefine( 100, ::oFld:aDialogs[2]  )
   ::oTreeGroups:bLDblClick:= {|| ::AddSelectedGroup() }

   ::oTreeSelectedGroups   := TTreeView():Redefine( 110, ::oFld:aDialogs[2]  )




   TButton():ReDefine( 120, {||( ::AddSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 130, {||( ::DelSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 140, {||( ::UpSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 150, {||( ::DownSelectedGroup() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )




   TButton():ReDefine( 160, {||( ::BtnDefectoGrupo() )}, ::oFld:aDialogs[2],,, .F.,,,, .F. )

   end





   ::oBrwCol                        := TXBrowse():New( if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ) )

   ::oBrwCol:bClrSel                := {|| { 0, ( 229 + ( 229 * 256 ) + ( 229 * 65536 ) ) } }
   ::oBrwCol:bClrSelFocus           := {|| { 0, ( 167 + ( 205 * 256 ) + ( 240 * 65536 ) ) } }

   ::oBrwCol:SetArray( ::aoCols, , , .F. )

   ::oBrwCol:nMarqueeStyle          := 5
   ::oBrwCol:lHScroll               := .F.

   ::oBrwCol:bLDblClick := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lEditCol(), ::oBrwCol:Refresh() }
   ::oBrwCol:bRClicked  := {| nRow, nCol | ::oBrwCol:LButtonDown( nRow, nCol ), ::aoCols[ ::oBrwCol:nArrayAt ]:Toogle(), ::oBrwCol:Refresh() }

   ::oBrwCol:CreateFromResource( 200 )

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Se.Seleccionada"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSelect }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Columna"
      :bStrData         := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:cDescrip }
      :nWidth           := 140
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Título"
      :bStrData         := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:cTitle }
      :nWidth           := 140
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Alineación"
      :bStrData         := {|| aPad[ Max( ::aoCols[ ::oBrwCol:nArrayAt ]:nPad, 1 ) ] }
      :nWidth           := 70
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "To.Totalizada"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lTotal }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "Sp.Separación"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSeparador }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end

   with object ( ::oBrwCol:AddCol() )
      :cHeader          := "So.Sombra"
      :bStrData         := {|| "" }
      :bEditValue       := {|| ::aoCols[ ::oBrwCol:nArrayAt ]:lSombra }
      :nWidth           := 20
      :SetCheck( { "Sel16", "Nil16" } )
   end




   TButton():ReDefine( 538, {||::UpColumn()}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 539, {||::DwColumn()}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 514, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:Select(), ::oBrwCol:SetFocus(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 540, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:UnSelect(), ::oBrwCol:SetFocus(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   TButton():ReDefine( 501, {||( ::aoCols[ ::oBrwCol:nArrayAt ]:lEditCol(), ::oBrwCol:Refresh() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )




   ::oBtnOriginal := TButton():ReDefine( 517, {||( ::PutOriginal() )}, if( ::lNewInforme, ::oFld:aDialogs[3], ::oFld:aDialogs[2] ),,, .F.,,,, .F. )








   aoFont[1] := TComboBox():ReDefine( 210, { | u | If( PCount()==0, ::acFont[1], ::acFont[1]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )




   aoSizes[1] := TComboBox():ReDefine( 220, { | u | If( PCount()==0, ::acSizes[1], ::acSizes[1]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )




   aoEstilo[1] := TComboBox():ReDefine( 230, { | u | If( PCount()==0, ::acEstilo[1], ::acEstilo[1]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )




   aoFont[2] := TComboBox():ReDefine( 240, { | u | If( PCount()==0, ::acFont[2], ::acFont[2]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )




   aoSizes[2] := TComboBox():ReDefine( 250, { | u | If( PCount()==0, ::acSizes[2], ::acSizes[2]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )




   aoEstilo[2] := TComboBox():ReDefine( 260, { | u | If( PCount()==0, ::acEstilo[2], ::acEstilo[2]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )




   aoFont[3] := TComboBox():ReDefine( 270, { | u | If( PCount()==0, ::acFont[3], ::acFont[3]:= u ) }, ::aFont, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )




   aoSizes[3] := TComboBox():ReDefine( 280, { | u | If( PCount()==0, ::acSizes[3], ::acSizes[3]:= u ) }, aSizes, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )




   aoEstilo[3] := TComboBox():ReDefine( 290, { | u | If( PCount()==0, ::acEstilo[3], ::acEstilo[3]:= u ) }, aEstilo, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )



   oCellView := TCheckBox():ReDefine( 300, { | u | If( PCount()==0, ::lCellView, ::lCellView:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,, .F. )



   oShadow := TCheckBox():ReDefine( 310, { | u | If( PCount()==0, ::lShadow, ::lShadow:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,, .F. )





   TGetHlp():ReDefine( 320, { | u | If( PCount()==0, ::nLenPage, ::nLenPage:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 330, { | u | If( PCount()==0, ::nWidthPage, ::nWidthPage:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )




   ::oOrientation := TComboBox():ReDefine( ( 420), { | u | If( PCount()==0, ::cOrientation, ::cOrientation:= u ) }, ::aOrientation, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,, .F.,,,,,, )







   oImagen := TGetHlp():ReDefine( 340, { | u | If( PCount()==0, ::cImagen, ::cImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )

   oImagen:cBmp   := "Folder"
   oImagen:bHelp  := {|| oImagen:cText( cGetFile( "*.bmp", "Selección de imagen" ) ), oImagen:lValid() }
   oImagen:bValid := {|| if( !Empty( Rtrim( ::cImagen ) ), ::oBmpImagen:LoadBmp( Rtrim( ::cImagen ) ), ), .T. }




   ::oBmpImagen := TBitmap():ReDefine( 400,, ::cImagen, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,, .F., .F.,,, .F.,,, .F. )





   TGetHlp():ReDefine( 360, { | u | If( PCount()==0, ::nFilaImagen, ::nFilaImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 370, { | u | If( PCount()==0, ::nColumnaImagen, ::nColumnaImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 380, { | u | If( PCount()==0, ::nAnchoImagen, ::nAnchoImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )





   TGetHlp():ReDefine( 390, { | u | If( PCount()==0, ::nAltoImagen, ::nAltoImagen:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),, "@E 9999.99",,,,,,, .F.,,, .F., .T.,,,,,, nil,,, )








   oPrinter := TGetHlp():ReDefine( 350, { | u | If( PCount()==0, ::cPrinter, ::cPrinter:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F., {||     ( .F. )},, .F., .F.,,,,,, nil,,, )

   TBtnBmp():ReDefine( 351, "Printer_preferences_16",,,,,{|| PrinterPreferences( oPrinter ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ), .F., , .F.,  )







   TGetHlp():ReDefine( 410, { | u | If( PCount()==0, ::cFooter, ::cFooter:= u ) }, if( ::lNewInforme, ::oFld:aDialogs[4], ::oFld:aDialogs[3] ),,,,,,,,, .F.,,, .F., .F.,,,,,, nil,,, )








   ::oBtnFilter := TButton():ReDefine( 510, {||( ::DlgFilter(), if( !Empty( ::oFilter:bExpFilter ) .OR. !Empty( ::oFilter:aExpFilter ), SetWindowText( ::oBtnFilter:hWnd, "Filtro activo" ), SetWindowText( ::oBtnFilter:hWnd, "Filtrar" ) ) )}, ::oDlg,,, .F.,,,, .F. )




   ::oBtnAction := TButton():ReDefine( 560, {||( ::GenReport() )}, ::oDlg,,, .F.,,,, .F. )






   ::oCmbReport := TComboBox():ReDefine( 600, { | u | If( PCount()==0, ::cCmbReport, ::cCmbReport:= u ) }, ::aCmbReport, ::oDlg,,,,,,, .F.,, ::aBmpReport,,,, )





   ::oBtnCancel := TButton():ReDefine( 570, {||( ::lBreak := .T., ::End() )}, ::oDlg,,, .F.,,,, .T. )

RETURN .T.



UTILITY STATIC function TNewInfGen_lGrupoArticulo( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   IIF( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if ::oDbfArt == nil .OR. !::oDbfArt:Used()
      ::oDbfArt := DbfServer( "ARTICULO.DBF", ):NewOpen( "ARTICULO.DBF",, ( cDriver() ),, ( cPatArt() ), .F., .T., .F., .F. ) ; ::oDbfArt:AddBag( "ARTICULO.CDX" ) ; ::oDbfArt:AddBag( ) ; ::oDbfArt:AutoIndex()
   end

   ::oGrupoArticulo                    := TRGroup():New( {|| ::oDbf:cCodArt }, {|| "Artículo : " + AllTrim( ::oDbf:cCodArt ) + " - " + AllTRim( ::oDbf:cNomArt ) }, {|| "Total artículo..." }, {|| 3 }, ::lSalto )

   ::oGrupoArticulo:Cargo              := TItemGroup()
   ::oGrupoArticulo:Cargo:Nombre       := "Artículo"
   ::oGrupoArticulo:Cargo:Expresion    := "cCodArt"
   ::oGrupoArticulo:Cargo:Todos        := .T.
   ::oGrupoArticulo:Cargo:Desde        := Space( 18 )
   ::oGrupoArticulo:Cargo:Hasta        := Replicate( "Z", 18 )
   ::oGrupoArticulo:Cargo:cPicDesde    := Replicate( "#", 18 )
   ::oGrupoArticulo:Cargo:cPicHasta    := Replicate( "#", 18 )
   ::oGrupoArticulo:Cargo:TextDesde    := {|| oRetFld( ::oGrupoArticulo:Cargo:Desde, ::oDbfArt, "Nombre", "Codigo" ) }
   ::oGrupoArticulo:Cargo:TextHasta    := {|| oRetFld( ::oGrupoArticulo:Cargo:Hasta, ::oDbfArt, "Nombre", "Codigo" ) }
   ::oGrupoArticulo:Cargo:HelpDesde    := {|| BrwArticulo( ::oDesde, ::oSayDesde, , .F. ) }
   ::oGrupoArticulo:Cargo:HelpHasta    := {|| BrwArticulo( ::oHasta, ::oSayHasta, , .F. ) }
   ::oGrupoArticulo:Cargo:ValidDesde   := {|oGet| if( cArticulo( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfArt:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoArticulo:Cargo:ValidHasta   := {|oGet| if( cArticulo( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfArt:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoArticulo:Cargo:lImprimir    := lImp
   ::oGrupoArticulo:Cargo:cBitmap      := "Cube_Yellow_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "Cube_Yellow_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoArticulo )

      if !Empty( ::oImageGroup )

         ::oImageGroup:AddMasked( TBitmap():Define( "Cube_Yellow_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

         ::oGrupoArticulo:Cargo:Imagen := len( ::oImageGroup:aBitmaps ) - 1

      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoArticulo:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoArticulo )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoArticulo )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfArt )
         ::oDbfArt:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoCliente( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfCli == nil .OR. !::oDbfCli:Used()
      ::oDbfCli := DbfServer( "CLIENT.DBF", ):NewOpen( "CLIENT.DBF",, ( cDriver() ),, ( cPatCli() ), .F., .T., .F., .F. ) ; ::oDbfCli:AddBag( "CLIENT.CDX" ) ; ::oDbfCli:AddBag( ) ; ::oDbfCli:AutoIndex()
   end

   ::oGrupoCliente                  := TRGroup():New( {|| ::oDbf:cCodCli }, {|| "Cliente : " + AllTrim( ::oDbf:cCodCli ) + " - " + AllTRim( ::oDbf:cNomCli ) }, {|| "Total cliente : " + ::oDbf:cCodCli }, {|| 3 }, ::lSalto )

   ::oGrupoCliente:Cargo            := TItemGroup()
   ::oGrupoCliente:Cargo:Nombre     := "Cliente"
   ::oGrupoCliente:Cargo:Expresion  := "cCodCli"
   ::oGrupoCliente:Cargo:Todos      := .T.
   ::oGrupoCliente:Cargo:Desde      := Space( RetNumCodCliEmp() )
   ::oGrupoCliente:Cargo:Hasta      := Replicate( "Z", RetNumCodCliEmp() )
   ::oGrupoCliente:Cargo:cPicDesde  := Replicate( "X", RetNumCodCliEmp() )
   ::oGrupoCliente:Cargo:cPicHasta  := Replicate( "X", RetNumCodCliEmp() )
   ::oGrupoCliente:Cargo:HelpDesde  := {|| BrwCli( ::oDesde, ::oSayDesde, ::oDbfCli:cAlias ) }
   ::oGrupoCliente:Cargo:HelpHasta  := {|| BrwCli( ::oHasta, ::oSayHasta, ::oDbfCli:cAlias ) }
   ::oGrupoCliente:Cargo:TextDesde  := {|| oRetFld( ::oGrupoCliente:Cargo:Desde, ::oDbfCli, "TITULO", "COD" ) }
   ::oGrupoCliente:Cargo:TextHasta  := {|| oRetFld( ::oGrupoCliente:Cargo:Hasta, ::oDbfCli, "TITULO", "COD" ) }
   ::oGrupoCliente:Cargo:ValidDesde := {|oGet| if( cClient( if( !Empty( oGet ), oGet, ::oDesde ), , ::oDbfCli:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCliente:Cargo:ValidHasta := {|oGet| if( cClient( if( !Empty( oGet ), oGet, ::oHasta ), , ::oDbfCli:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCliente:Cargo:lImprimir  := lImp
   ::oGrupoCliente:Cargo:cBitmap    := "User1_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoCliente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCliente )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoCliente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoCliente:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCliente:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCliente )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCliente )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfCli )
         ::oDbfCli:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoProveedor( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfPrv == nil .OR. !::oDbfPrv:Used()
      ::oDbfPrv := DbfServer( "PROVEE.DBF", ):NewOpen( "PROVEE.DBF",, ( cDriver() ),, ( cPatPrv() ), .F., .T., .F., .F. ) ; ::oDbfPrv:AddBag( "PROVEE.CDX" ) ; ::oDbfPrv:AddBag( ) ; ::oDbfPrv:AutoIndex()
   end

   ::oGrupoProveedor                  := TRGroup():New( {|| ::oDbf:cCodPrv }, {|| "Proveedor : " + AllTrim( ::oDbf:cCodPrv ) + " - " + AllTRim( ::oDbf:cNomPrv ) }, {|| "Total proveedor..." }, {|| 3 }, ::lSalto )

   ::oGrupoProveedor:Cargo            := TItemGroup()
   ::oGrupoProveedor:Cargo:Nombre     := "Proveedor"
   ::oGrupoProveedor:Cargo:Expresion  := "cCodPrv"
   ::oGrupoProveedor:Cargo:Todos      := .T.
   ::oGrupoProveedor:Cargo:Desde      := Space( RetNumCodPrvEmp() )
   ::oGrupoProveedor:Cargo:Hasta      := Replicate( "Z", RetNumCodPrvEmp() )
   ::oGrupoProveedor:Cargo:cPicDesde  := Replicate( "X", RetNumCodPrvEmp() )
   ::oGrupoProveedor:Cargo:cPicHasta  := Replicate( "X", RetNumCodPrvEmp() )
   ::oGrupoProveedor:Cargo:TextDesde  := {|| oRetFld( ::oGrupoProveedor:Cargo:Desde, ::oDbfPrv, "Titulo", "Cod" ) }
   ::oGrupoProveedor:Cargo:TextHasta  := {|| oRetFld( ::oGrupoProveedor:Cargo:Hasta, ::oDbfPrv, "Titulo", "Cod" ) }
   ::oGrupoProveedor:Cargo:HelpDesde  := {|| BrwPrv( ::oDesde, , ::oDbfPrv:cAlias ) }
   ::oGrupoProveedor:Cargo:HelpHasta  := {|| BrwPrv( ::oHasta, , ::oDbfPrv:cAlias) }
   ::oGrupoProveedor:Cargo:ValidDesde := {|oGet| if( cProvee( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfPrv:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoProveedor:Cargo:ValidHasta := {|oGet| if( cProvee( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfPrv:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoProveedor:Cargo:lImprimir  := lImp
   ::oGrupoProveedor:Cargo:cBitmap     := "Businessman_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoProveedor:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoProveedor )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoProveedor:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoProveedor:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoProveedor:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoProveedor )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoProveedor )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfPrv )
         ::oDbfPrv:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoOperacion( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oOperacion         :=  TOperacion():CreateInit( cPatEmp() )
   ::oOperacion:Openfiles()

   ::oGrupoOperacion                  := TRGroup():New( {|| ::oDbf:cCodOpe }, {|| "Operación : " + AllTrim( ::oDbf:cCodOpe ) + " - " + AllTRim( ::oDbf:cNomOpe ) }, {|| "Total operación..." }, {|| 3 }, ::lSalto )

   ::oGrupoOperacion:Cargo            := TItemGroup()
   ::oGrupoOperacion:Cargo:Nombre     := "Operación"
   ::oGrupoOperacion:Cargo:Expresion  := "cCodOpe"
   ::oGrupoOperacion:Cargo:Todos      := .T.
   ::oGrupoOperacion:Cargo:Desde      := Space( 3 )
   ::oGrupoOperacion:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoOperacion:Cargo:cPicDesde  := "@!"
   ::oGrupoOperacion:Cargo:cPicHasta  := "@!"
   ::oGrupoOperacion:Cargo:HelpDesde  := {|| ::oOperacion:Buscar( ::oDesde ) }
   ::oGrupoOperacion:Cargo:HelpHasta  := {|| ::oOperacion:Buscar( ::oHasta ) }
   ::oGrupoOperacion:Cargo:ValidDesde := {|oGet| if( ::oOperacion:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesOpe", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoOperacion:Cargo:ValidHasta := {|oGet| if( ::oOperacion:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesOpe", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoOperacion:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Worker2_Hammer2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoOperacion )

      ::oImageGroup:AddMasked( TBitmap():Define( "Worker2_Hammer2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoOperacion:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoOperacion:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoOperacion )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoOperacion )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oOperacion )
         ::oOperacion:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoTOperacion( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oTipOpera                         := TTipOpera():Create( cPatEmp() )
   ::oTipOpera:Openfiles()

   ::oGrupoTOperacion                  := TRGroup():New( {|| ::oDbf:cCodTOpe }, {|| "Tip. operación: " + AllTrim( ::oDbf:cCodTOpe ) + " - " + AllTRim( ::oDbf:cNomTOpe ) }, {|| "Total tip. operación: " + AllTrim( ::oDbf:cCodTOpe ) }, {|| 3 }, ::lSalto )

   ::oGrupoTOperacion:Cargo            := TItemGroup()
   ::oGrupoTOperacion:Cargo:Nombre     := "Tipo operación"
   ::oGrupoTOperacion:Cargo:Expresion  := "cCodTOpe"
   ::oGrupoTOperacion:Cargo:Todos      := .T.
   ::oGrupoTOperacion:Cargo:Desde      := Space( 3 )
   ::oGrupoTOperacion:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoTOperacion:Cargo:cPicDesde  := "@!"
   ::oGrupoTOperacion:Cargo:cPicHasta  := "@!"
   ::oGrupoTOperacion:Cargo:HelpDesde  := {|| ::oTipOpera:Buscar( ::oDesde ) }
   ::oGrupoTOperacion:Cargo:HelpHasta  := {|| ::oTipOpera:Buscar( ::oHasta ) }
   ::oGrupoTOperacion:Cargo:ValidDesde := {|oGet| if( ::oTipOpera:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTOperacion:Cargo:ValidHasta := {|oGet| if( ::oTipOpera:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTOperacion:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Worker_Folder_Blue_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoTOperacion )

      ::oImageGroup:AddMasked( TBitmap():Define( "Worker_Folder_Blue_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoTOperacion:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTOperacion:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTOperacion )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTOperacion )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oTipOpera )
         ::oTipOpera:End()
      end

      lOpen                            := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoSeccion( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oSeccion                       := TSeccion():Create( cPatEmp() )
   ::oSeccion:Openfiles()

   ::oGrupoSeccion                  := TRGroup():New( {|| ::oDbf:cCodSec }, {|| "Sección : " + ::oDbf:cCodSec + " - " + ::oDbf:cNomSec }, {|| "Total sección : " + ::oDbf:cCodSec }, {|| 3 }, ::lSalto )

   ::oGrupoSeccion:Cargo            := TItemGroup()
   ::oGrupoSeccion:Cargo:Nombre     := "Sección"
   ::oGrupoSeccion:Cargo:Expresion  := "cCodSec"
   ::oGrupoSeccion:Cargo:Todos      := .T.
   ::oGrupoSeccion:Cargo:Desde      := Space( 3 )
   ::oGrupoSeccion:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoSeccion:Cargo:cPicDesde  := "@!"
   ::oGrupoSeccion:Cargo:cPicHasta  := "@!"
   ::oGrupoSeccion:Cargo:HelpDesde  := {|| ::oSeccion:Buscar( ::oDesde ) }
   ::oGrupoSeccion:Cargo:HelpHasta  := {|| ::oSeccion:Buscar( ::oHasta ) }
   ::oGrupoSeccion:Cargo:ValidDesde := {|oGet| if( ::oSeccion:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesSec", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoSeccion:Cargo:ValidHasta := {|oGet| if( ::oSeccion:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesSec", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoSeccion:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Group_Worker2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoSeccion )

      ::oImageGroup:AddMasked( TBitmap():Define( "Group_Worker2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoSeccion:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoSeccion:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoSeccion )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoSeccion )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oSeccion )
         ::oSeccion:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoAlmacen( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfAlm == nil .OR. !::oDbfAlm:Used()
      ::oDbfAlm := DbfServer( "ALMACEN.DBF", ):NewOpen( "ALMACEN.DBF",, ( cDriver() ),, ( cPatAlm() ), .F., .T., .F., .F. ) ; ::oDbfAlm:AddBag( "ALMACEN.CDX" ) ; ::oDbfAlm:AddBag( ) ; ::oDbfAlm:AutoIndex()
   end

   ::oGrupoAlmacen                  := TRGroup():New( {|| ::oDbf:cCodAlm }, {|| "Almacén : " + AllTrim( ::oDbf:cCodAlm ) + " - " + AllTrim( ::oDbf:cNomAlm ) }, {|| "Total almacén : " + ::oDbf:cCodAlm }, {|| 3 }, ::lSalto )

   ::oGrupoAlmacen:Cargo            := TItemGroup()
   ::oGrupoAlmacen:Cargo:Nombre     := "Almacén"
   ::oGrupoAlmacen:Cargo:Expresion  := "cCodAlm"
   ::oGrupoAlmacen:Cargo:Todos      := .T.
   ::oGrupoAlmacen:Cargo:Desde      := Space( 3 )
   ::oGrupoAlmacen:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoAlmacen:Cargo:cPicDesde  := Replicate( "#", 3 )
   ::oGrupoAlmacen:Cargo:cPicHasta  := Replicate( "#", 3 )
   ::oGrupoAlmacen:Cargo:TextDesde  := {|| oRetFld( ::oGrupoAlmacen:Cargo:Desde, ::oDbfAlm, "cNomAlm", "cCodAlm" ) }
   ::oGrupoAlmacen:Cargo:TextHasta  := {|| oRetFld( ::oGrupoAlmacen:Cargo:Hasta, ::oDbfAlm, "cNomAlm", "cCodAlm" ) }
   ::oGrupoAlmacen:Cargo:HelpDesde  := {|| BrwAlmacen( ::oDesde, ::oSayDesde ) }
   ::oGrupoAlmacen:Cargo:HelpHasta  := {|| BrwAlmacen( ::oHasta, ::oSayHasta ) }
   ::oGrupoAlmacen:Cargo:ValidDesde := {|oGet| if( cAlmacen( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfAlm:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAlmacen:Cargo:ValidHasta := {|oGet| if( cAlmacen( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfAlm:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAlmacen:Cargo:lImprimir  := lImp
   ::oGrupoAlmacen:Cargo:cBitmap    := "Package_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "Package_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoAlmacen )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "Package_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoAlmacen:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoAlmacen:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoAlmacen )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoAlmacen )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfAlm )
         ::oDbfAlm:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoMaquina( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oMaquina           :=  TMaquina():CreateInit( cPatEmp() )
   ::oMaquina:Openfiles()

   ::oGrupoMaquina                  := TRGroup():New( {|| ::oDbf:cCodMaq }, {|| "Máquina : " + ::oDbf:cCodMaq + " - " + ::oDbf:cNomMaq }, {|| "Total máquina : " + ::oDbf:cCodMaq }, {|| 3 }, ::lSalto )

   ::oGrupoMaquina:Cargo            := TItemGroup()
   ::oGrupoMaquina:Cargo:Nombre     := "Maquina"
   ::oGrupoMaquina:Cargo:Expresion  := "cCodMaq"
   ::oGrupoMaquina:Cargo:Todos      := .T.
   ::oGrupoMaquina:Cargo:Desde      := Space( 3 )
   ::oGrupoMaquina:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoMaquina:Cargo:cPicDesde  := "@!"
   ::oGrupoMaquina:Cargo:cPicHasta  := "@!"
   ::oGrupoMaquina:Cargo:HelpDesde  := {|| ::oMaquina:Buscar( ::oDesde ) }
   ::oGrupoMaquina:Cargo:HelpHasta  := {|| ::oMaquina:Buscar( ::oHasta ) }
   ::oGrupoMaquina:Cargo:ValidDesde := {|oGet| if( ::oMaquina:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesMaq", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoMaquina:Cargo:ValidHasta := {|oGet| if( ::oMaquina:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesMaq", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoMaquina:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Robot_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoMaquina )

      ::oImageGroup:AddMasked( TBitmap():Define( "Robot_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoMaquina:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoMaquina:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoMaquina )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoMaquina )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oMaquina )
         ::oMaquina:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoOperario( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oOperario                       := TOperarios():Create( cPatEmp() )
   ::oOperario:Openfiles()

   ::oGrupoOperario                  := TRGroup():New( {|| ::oDbf:cCodTra }, {|| "Operario : " + ::oDbf:cCodTra + " - " + ::oDbf:cNomTra }, {|| "Total operario : " + ::oDbf:cCodTra }, {|| 3 }, ::lSalto )

   ::oGrupoOperario:Cargo            := TItemGroup()
   ::oGrupoOperario:Cargo:Nombre     := "Operario"
   ::oGrupoOperario:Cargo:Expresion  := "cCodTra"
   ::oGrupoOperario:Cargo:Todos      := .T.
   ::oGrupoOperario:Cargo:Desde      := Space( 5 )
   ::oGrupoOperario:Cargo:Hasta      := Replicate( "Z", 5 )
   ::oGrupoOperario:Cargo:cPicDesde  := "@!"
   ::oGrupoOperario:Cargo:cPicHasta  := "@!"
   ::oGrupoOperario:Cargo:HelpDesde  := {|| ::oOperario:Buscar( ::oDesde ) }
   ::oGrupoOperario:Cargo:HelpHasta  := {|| ::oOperario:Buscar( ::oHasta ) }
   ::oGrupoOperario:Cargo:ValidDesde := {|oGet| if( ::oOperario:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomTra", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoOperario:Cargo:ValidHasta := {|oGet| if( ::oOperario:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomTra", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoOperario:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Worker2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoOperario )

      ::oImageGroup:AddMasked( TBitmap():Define( "Worker2_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoOperario:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoOperario:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoOperario )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoOperario )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oOperario )
         ::oOperario:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoFPago( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   IIF( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if ::oDbfFpg == nil .OR. !::oDbfFpg:Used()
      ::oDbfFpg := DbfServer( "FPago.Dbf", ):NewOpen( "FPago.Dbf",, ( cDriver() ),, ( cPatGrp() ), .F., .T., .F., .F. ) ; ::oDbfFpg:AddBag( "FPago.Cdx" ) ; ::oDbfFpg:AddBag( ) ; ::oDbfFpg:AutoIndex()
   end

   ::oGrupoFpago                   := TRGroup():New( {|| ::oDbf:cCodFpg }, {|| "F. pago : " + AllTrim( ::oDbf:cCodFpg ) + " - " + AllTRim( ::oDbf:cNomFpg ) }, {|| "Total forma de pago : " + ::oDbf:cCodFpg }, {|| 3 }, ::lSalto )

   ::oGrupoFpago:Cargo             := TItemGroup()
   ::oGrupoFpago:Cargo:Nombre      := "Forma pago"
   ::oGrupoFpago:Cargo:Expresion   := "cCodFpg"
   ::oGrupoFpago:Cargo:Todos       := .T.
   ::oGrupoFpago:Cargo:Desde       := Space( 2 )
   ::oGrupoFpago:Cargo:Hasta       := Replicate( "Z", 2 )
   ::oGrupoFpago:Cargo:cPicDesde   := "@!"
   ::oGrupoFpago:Cargo:cPicHasta   := "@!"
   ::oGrupoFpago:Cargo:TextDesde   := {|| oRetFld( ::oGrupoFpago:Cargo:Desde, ::oDbfFpg, "cDesPago", "cCodPago" ) }
   ::oGrupoFpago:Cargo:TextHasta   := {|| oRetFld( ::oGrupoFpago:Cargo:Hasta, ::oDbfFpg, "cDesPago", "cCodPago" ) }
   ::oGrupoFpago:Cargo:HelpDesde   := {|| BrwFPago( ::oDesde, ::oSayDesde ) }
   ::oGrupoFpago:Cargo:HelpHasta   := {|| BrwFPago( ::oHasta, ::oSayHasta ) }
   ::oGrupoFpago:Cargo:ValidDesde  := {|oGet| if( cFpago( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfFpg:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFpago:Cargo:ValidHasta  := {|oGet| if( cFpago( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfFpg:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFPago:Cargo:lImprimir   := lImp
   ::oGrupoFPago:Cargo:cBitmap     := "Creditcards_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoFPago:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFpago )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoFPago:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoFpago:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFPago:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFpago )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFpago )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfFpg )
         ::oDbfFpg:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoBanco( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oBanco             := TBancos():Create( cPatGrp() )
   ::oBanco:OpenFiles()

   ::oGrupoBanco                    := TRGroup():New( {|| ::oDbf:cCodBnc }, {|| "Banco : " + AllTrim( ::oDbf:cCodBnc ) + " - " + AllTRim( ::oDbf:cNomBnc ) }, {|| "Total banco : " + ::oDbf:cCodBnc }, {|| 3 }, ::lSalto )

   ::oGrupoBanco:Cargo              := TItemGroup()
   ::oGrupoBanco:Cargo:Nombre       := "Banco"
   ::oGrupoBanco:Cargo:Expresion    := "cCodBnc"
   ::oGrupoBanco:Cargo:Todos        := .T.
   ::oGrupoBanco:Cargo:Desde        := Space( 4 )
   ::oGrupoBanco:Cargo:Hasta        := Replicate( "Z", 4 )
   ::oGrupoBanco:Cargo:cPicDesde    := "@!"
   ::oGrupoBanco:Cargo:cPicHasta    := "@!"
   ::oGrupoBanco:Cargo:HelpDesde    := {|| ::oBanco:Buscar( ::oDesde ) }
   ::oGrupoBanco:Cargo:HelpHasta    := {|| ::oBanco:Buscar( ::oHasta ) }
   ::oGrupoBanco:Cargo:ValidDesde   := {|oGet| if( ::oBanco:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomBnc", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoBanco:Cargo:ValidHasta   := {|oGet| if( ::oBanco:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomBnc", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoBanco:Cargo:lImprimir    := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Banc_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoBanco )

      ::oImageGroup:AddMasked( TBitmap():Define( "Banc_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoBanco:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoBanco:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoBanco )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoBanco )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::Banco )
         ::oBanco:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoAgente( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   IIF( lImp == nil, lImp := .T., ) ;

   oBlock               :=  ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   if ::oDbfAge == nil .OR. !::oDbfAge:Used()
      ::oDbfAge := DbfServer( "AGENTES.DBF", ):NewOpen( "AGENTES.DBF",, ( cDriver() ),, ( cPatCli() ), .F., .T., .F., .F. ) ; ::oDbfAge:AddBag( "AGENTES.CDX" ) ; ::oDbfAge:AddBag( ) ; ::oDbfAge:AutoIndex()
   end

    ::oGrupoAgente                  := TRGroup():New( {|| ::oDbf:cCodAge }, {|| "Agente : " + AllTrim( ::oDbf:cCodAge ) + " - " + AllTrim( ::oDbf:cApeAge ) + "," + AllTRim( ::oDbf:cNomAge ) }, {|| "Total agente : " + ::oDbf:cCodAge }, {|| 3 }, ::lSalto )

   ::oGrupoAgente:Cargo            := TItemGroup()
   ::oGrupoAgente:Cargo:Nombre     := "Agente"
   ::oGrupoAgente:Cargo:Expresion  := "cCodAge"
   ::oGrupoAgente:Cargo:Todos      := .T.
   ::oGrupoAgente:Cargo:Desde      := Space( 3 )
   ::oGrupoAgente:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoAgente:Cargo:cPicDesde  := "@!"
   ::oGrupoAgente:Cargo:cPicHasta  := "@!"
   ::oGrupoAgente:Cargo:TextDesde  := {|| oRetFld( ::oGrupoAgente:Cargo:Desde, ::oDbfAge, "cNbrAge", "cCodAge" ) }
   ::oGrupoAgente:Cargo:TextHasta  := {|| oRetFld( ::oGrupoAgente:Cargo:Hasta, ::oDbfAge, "cNbrAge", "cCodAge" ) }
   ::oGrupoAgente:Cargo:HelpDesde  := {|| BrwAgentes( ::oDesde, ::oSayDesde ) }
   ::oGrupoAgente:Cargo:HelpHasta  := {|| BrwAgentes( ::oHasta, ::oSayHasta ) }
   ::oGrupoAgente:Cargo:ValidDesde := {|oGet| if( cAgentes( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfAge:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAgente:Cargo:ValidHasta := {|oGet| if( cAgentes( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfAge:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoAgente:Cargo:lImprimir  := lImp
   ::oGrupoAgente:Cargo:cBitmap    := "Security_Agent_16"

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoAgente )

      if !Empty( ::oImageGroup )

         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoAgente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

         ::oGrupoAgente:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1

      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoAgente:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoAgente )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoAgente )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfAge )
         ::oDbfAge:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoUsuario( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfUsr == nil .OR. !::oDbfUsr:Used()
      ::oDbfUsr := DbfServer( "USERS.DBF", ):NewOpen( "USERS.DBF",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfUsr:AddBag( "USERS.CDX" ) ; ::oDbfUsr:AddBag( ) ; ::oDbfUsr:AutoIndex()
   end

   ::oGrupoUsuario                  := TRGroup():New( {|| ::oDbf:cCodUsr }, {|| "Usuario : " + AllTrim( ::oDbf:cCodUsr ) + " - " + AllTRim( ::oDbf:cNomUsr ) }, {|| "Total usuario : " + ::oDbf:cCodUsr }, {|| 3 }, ::lSalto )

   ::oGrupoUsuario:Cargo            := TItemGroup()
   ::oGrupoUsuario:Cargo:Nombre     := "Usuario"
   ::oGrupoUsuario:Cargo:Expresion  := "cCodUsr"
   ::oGrupoUsuario:Cargo:Todos      := .T.
   ::oGrupoUsuario:Cargo:Desde      := Space( 3 )
   ::oGrupoUsuario:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoUsuario:Cargo:cPicDesde  := "@!"
   ::oGrupoUsuario:Cargo:cPicHasta  := "@!"

   ::oGrupoUsuario:Cargo:TextDesde  := {|| oRetFld( ::oGrupoUsuario:Cargo:Desde, ::oDbfUsr, "CNBRUSE", "CCODUSE" ) }
   ::oGrupoUsuario:Cargo:TextHasta  := {|| oRetFld( ::oGrupoUsuario:Cargo:Hasta, ::oDbfUsr, "CNBRUSE", "CCODUSE" ) }

   ::oGrupoUsuario:Cargo:HelpDesde  := {|| BrwUser( ::oDesde, ::oDbfUsr:cAlias, ::oSayDesde, .F., .F., .F. ) }
   ::oGrupoUsuario:Cargo:HelpHasta  := {|| BrwUser( ::oHasta, ::oDbfUsr:cAlias, ::oSayHasta, .F., .F., .F. ) }

   ::oGrupoUsuario:Cargo:ValidDesde := {|oGet| if( cUser( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfUsr:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoUsuario:Cargo:ValidHasta := {|oGet| if( cUser( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfUsr:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }

   ::oGrupoUsuario:Cargo:lImprimir  := lImp
   ::oGrupoUsuario:Cargo:cBitmap    := "Businessmen_16"

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoUsuario )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "Businessmen_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

         ::oGrupoUsuario:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoUsuario:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoUsuario )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoUsuario )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfUsr )
         ::oDbfUsr:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoCaja( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfCaj == nil .OR. !::oDbfCaj:Used()
      ::oDbfCaj := DbfServer( "CAJAS.DBF", ):NewOpen( "CAJAS.DBF",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfCaj:AddBag( "CAJAS.CDX" ) ; ::oDbfCaj:AddBag( ) ; ::oDbfCaj:AutoIndex()
   end

   ::oGrupoCaja                  := TRGroup():New( {|| ::oDbf:cCodCaj }, {|| "Caja : " + AllTrim( ::oDbf:cCodCaj ) + " - " + AllTRim( ::oDbf:cNomCaj ) }, {|| "Total caja : " + ::oDbf:cCodCaj }, {|| 3 }, ::lSalto )

   ::oGrupoCaja:Cargo            := TItemGroup()
   ::oGrupoCaja:Cargo:Nombre     := "Caja"
   ::oGrupoCaja:Cargo:Expresion  := "cCodCaj"
   ::oGrupoCaja:Cargo:Todos      := .T.
   ::oGrupoCaja:Cargo:Desde      := Space( 3 )
   ::oGrupoCaja:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoCaja:Cargo:cPicDesde  := "@!"
   ::oGrupoCaja:Cargo:cPicHasta  := "@!"
   ::oGrupoCaja:Cargo:HelpDesde  := {|| BrwCajas( ::oDesde, ::oSayDesde ) }
   ::oGrupoCaja:Cargo:HelpHasta  := {|| BrwCajas( ::oHasta, ::oSayHasta ) }
   ::oGrupoCaja:Cargo:ValidDesde := {|oGet| if( cCajas( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfCaj:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCaja:Cargo:ValidHasta := {|oGet| if( cCajas( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfCaj:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCaja:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Cashier_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCaja )

      ::oImageGroup:AddMasked( TBitmap():Define( "Cashier_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoCaja:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCaja:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCaja )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCaja )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfCaj )
         ::oDbfCaj:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoTransportista( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oDbfTrn            := TTrans():Create( cPatCli(), "Transport" )
   ::oDbfTrn:OpenFiles()

   ::oGrupoTransportista                  := TRGroup():New( {|| ::oDbf:cCodTrans }, {|| "Transportista : " + AllTrim( ::oDbf:cCodTrans ) + " - " + AllTRim( ::oDbf:cNomTrans ) }, {|| "Total transportista : " + ::oDbf:cCodTrans }, {|| 3 }, ::lSalto )

   ::oGrupoTransportista:Cargo            := TItemGroup()
   ::oGrupoTransportista:Cargo:Nombre     := "Transportista"
   ::oGrupoTransportista:Cargo:Expresion  := "cCodTrans"
   ::oGrupoTransportista:Cargo:Todos      := .T.
   ::oGrupoTransportista:Cargo:Desde      := Space( 9 )
   ::oGrupoTransportista:Cargo:Hasta      := Replicate( "Z", 9 )
   ::oGrupoTransportista:Cargo:cPicDesde  := "@!"
   ::oGrupoTransportista:Cargo:cPicHasta  := "@!"
   ::oGrupoTransportista:Cargo:HelpDesde  := {|| ::oDbfTrn:Buscar( ::oDesde ) }
   ::oGrupoTransportista:Cargo:HelpHasta  := {|| ::oDbfTrn:Buscar( ::oHasta ) }
   ::oGrupoTransportista:Cargo:TextDesde  := {|| oRetFld( ::oGrupoTransportista:Cargo:Desde, ::oDbfTrn:oDbf, "cNomTrn", "cCodTrn" ) }
   ::oGrupoTransportista:Cargo:TextHasta  := {|| oRetFld( ::oGrupoTransportista:Cargo:Hasta, ::oDbfTrn:oDbf, "cNomTrn", "cCodTrn" ) }
   ::oGrupoTransportista:Cargo:ValidDesde := {|oGet| if( ::oDbfTrn:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomTrn" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTransportista:Cargo:ValidHasta := {|oGet| if( ::oDbfTrn:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomTrn" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTransportista:Cargo:lImprimir  := lImp
   ::oGrupoTransportista:Cargo:cBitmap    := "Truck_Blue_16"

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoTransportista )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "Truck_Blue_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

         ::oGrupoTransportista:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTransportista:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTransportista )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTransportista )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )ç

      if !Empty( ::oDbfTrn )
         ::oDbfTrn:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoGCliente( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   IIF( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   ::oGrpCli                         := TGrpCli():Create( cPatCli() )
   ::oGrpCli:OpenFiles()

   ::oGrupoGCliente                  := TRGroup():New( {|| ::oDbf:cCodGCli }, {|| "Grp. cliente : " + AllTrim( ::oDbf:cCodGCli ) + " - " + AllTRim( ::oDbf:cNomGCli ) }, {|| "Total grp. cliente : " + ::oDbf:cCodGCli }, {|| 3 }, ::lSalto )

   ::oGrupoGCliente:Cargo            := TItemGroup()
   ::oGrupoGCliente:Cargo:Nombre     := "Grp. cliente"
   ::oGrupoGCliente:Cargo:Expresion  := "cCodGCli"
   ::oGrupoGCliente:Cargo:Todos      := .T.
   ::oGrupoGCliente:Cargo:Desde      := Space( 4 )
   ::oGrupoGCliente:Cargo:Hasta      := Replicate( "Z", 4 )
   ::oGrupoGCliente:Cargo:cPicDesde  := "@!"
   ::oGrupoGCliente:Cargo:cPicHasta  := "@!"
   ::oGrupoGCliente:Cargo:HelpDesde  := {|| ::oGrpCli:Buscar( ::oDesde ) }
   ::oGrupoGCliente:Cargo:HelpHasta  := {|| ::oGrpCli:Buscar( ::oHasta ) }
   ::oGrupoGCliente:Cargo:TextDesde  := {|| oRetFld( ::oGrupoGCliente:Cargo:Desde, ::oGrpCli:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGCliente:Cargo:TextHasta  := {|| oRetFld( ::oGrupoGCliente:Cargo:Hasta, ::oGrpCli:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGCliente:Cargo:ValidDesde := {|oGet| if( ::oGrpCli:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomGrp", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGCliente:Cargo:ValidHasta := {|oGet| if( ::oGrpCli:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomGrp", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGCliente:Cargo:lImprimir  := lImp
   ::oGrupoGCliente:Cargo:cBitmap    := "Users2_16"

   ::oGrupoGCliente:Cargo:bValidMayorIgual := {|uVal, uDesde| ::oGrpCli:IsPadreMayor( uVal, uDesde ) }
   ::oGrupoGCliente:Cargo:bValidMenorIgual := {|uVal, uHasta| ::oGrpCli:IsPadreMenor( uVal, uHasta ) }

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoGCliente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoGCliente )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoGCliente:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoGCliente:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoGCliente:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoGCliente )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoGCliente )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oGrpCli )
         ::oGrpCli:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoGProveedor( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oGrpPrv            := TGrpPrv():Create( cPatPrv() )
   ::oGrpPrv:OpenFiles()

   ::oGrupoGProveedor                  := TRGroup():New( {|| ::oDbf:cCodGPrv }, {|| "Grp. proveedor : " + AllTrim( ::oDbf:cCodGPrv ) + " - " + AllTRim( ::oDbf:cNomGPrv ) }, {|| "Total grp. proveedor : " + ::oDbf:cCodGPrv }, {|| 3 }, ::lSalto )

   ::oGrupoGProveedor:Cargo            := TItemGroup()
   ::oGrupoGProveedor:Cargo:Nombre     := "Grp. proveedor"
   ::oGrupoGProveedor:Cargo:Expresion  := "cCodGPrv"
   ::oGrupoGProveedor:Cargo:Todos      := .T.
   ::oGrupoGProveedor:Cargo:Desde      := Space( 4 )
   ::oGrupoGProveedor:Cargo:Hasta      := Replicate( "Z", 4 )
   ::oGrupoGProveedor:Cargo:cPicDesde  := Replicate( "X", RetNumCodPrvEmp() )
   ::oGrupoGProveedor:Cargo:cPicHasta  := Replicate( "X", RetNumCodPrvEmp() )
   ::oGrupoGProveedor:Cargo:TextDesde  := {|| oRetFld( ::oGrupoGProveedor:Cargo:Desde, ::oGrpPrv:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGProveedor:Cargo:TextHasta  := {|| oRetFld( ::oGrupoGProveedor:Cargo:Hasta, ::oGrpPrv:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGProveedor:Cargo:HelpDesde  := {|| ::oGrpPrv:Buscar( ::oDesde ) }
   ::oGrupoGProveedor:Cargo:HelpHasta  := {|| ::oGrpPrv:Buscar( ::oHasta ) }
   ::oGrupoGProveedor:Cargo:ValidDesde := {|oGet| if( ::oGrpPrv:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomGrp", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGProveedor:Cargo:ValidHasta := {|oGet| if( ::oGrpPrv:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomGrp", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGProveedor:Cargo:lImprimir  := lImp
   ::oGrupoGProveedor:Cargo:cBitmap     := "GrpPrv_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoGProveedor:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoGProveedor )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoGProveedor:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoGProveedor:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoGProveedor:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoGProveedor )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoGProveedor )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oGrpPrv )
         ::oGrpPrv:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoObra( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfObr == nil .OR. !::oDbfObr:Used()
      ::oDbfObr := DbfServer( "OBRAST.DBF", ):NewOpen( "OBRAST.DBF",, ( cDriver() ),, ( cPatCli() ), .F., .T., .F., .F. ) ; ::oDbfObr:AddBag( "OBRAST.CDX" ) ; ::oDbfObr:AddBag( ) ; ::oDbfObr:AutoIndex()
   end

   ::oGrupoObra                  := TRGroup():New( {|| ::oDbf:cCodObra }, {|| "Obra : " + AllTrim( ::oDbf:cCodObra ) + " - " + AllTRim( ::oDbf:cNomObra ) }, {|| "Total obra : " + ::oDbf:cCodObra }, {|| 3 }, ::lSalto )

   ::oGrupoObra:Cargo            := TItemGroup()
   ::oGrupoObra:Cargo:Nombre     := "Obra"
   ::oGrupoObra:Cargo:Expresion  := "cCodObra"
   ::oGrupoObra:Cargo:Todos      := .T.
   ::oGrupoObra:Cargo:Desde      := Space( 10 )
   ::oGrupoObra:Cargo:Hasta      := Replicate( "Z", 10 )
   ::oGrupoObra:Cargo:cPicDesde  := "@!"
   ::oGrupoObra:Cargo:cPicHasta  := "@!"
   ::oGrupoObra:Cargo:HelpDesde  := {|| BrwObras( ::oDesde, ::oSayDesde, ::oGrupoCliente:Cargo:Desde, ::oDbfObr:cAlias ) }
   ::oGrupoObra:Cargo:HelpHasta  := {|| BrwObras( ::oHasta, ::oSayHasta, ::oGrupoCliente:Cargo:Desde, ::oDbfObr:cAlias ) }
   ::oGrupoObra:Cargo:ValidDesde := {|oGet| if( cObras( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, ::oGrupoCliente:Cargo:Desde, ::oDbfObr:cAlias ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoObra:Cargo:ValidHasta := {|oGet| if( cObras( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, ::oGrupoCliente:Cargo:Desde, ::oDbfObr:cAlias ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoObra:Cargo:bCondition := {|| ::lIgualCliente() }
   ::oGrupoObra:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "User1_Hammer_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoObra )

      ::oImageGroup:AddMasked( TBitmap():Define( "User1_Hammer_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoObra:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoObra:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoObra )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoObra )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfObr )
         ::oGrpObr:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoFamilia( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfFam == nil .OR. !::oDbfFam:Used()
      ::oDbfFam := DbfServer( "FAMILIAS.DBF", ):NewOpen( "FAMILIAS.DBF",, ( cDriver() ),, ( cPatArt() ), .F., .T., .F., .F. ) ; ::oDbfFam:AddBag( "FAMILIAS.CDX" ) ; ::oDbfFam:AddBag( ) ; ::oDbfFam:AutoIndex()
   end

   ::oGrupoFamilia                    := TRGroup():New( {|| ::oDbf:cCodFam }, {|| "Familia : " + AllTrim( ::oDbf:cCodFam ) + " - " + AllTRim( ::oDbf:cNomFam ) }, {|| "Total familia : " + ::oDbf:cCodFam }, {|| 3 }, ::lSalto )

   ::oGrupoFamilia:Cargo              := TItemGroup()
   ::oGrupoFamilia:Cargo:Nombre       := "Familia"
   ::oGrupoFamilia:Cargo:Expresion    := "cCodFam"
   ::oGrupoFamilia:Cargo:Todos        := .T.
   ::oGrupoFamilia:Cargo:Desde        := Space( 16 )
   ::oGrupoFamilia:Cargo:Hasta        := Replicate( "Z", 16 )
   ::oGrupoFamilia:Cargo:cPicDesde    := "@!"
   ::oGrupoFamilia:Cargo:cPicHasta    := "@!"
   ::oGrupoFamilia:Cargo:HelpDesde    := {|| BrwFamilia( ::oDesde, ::oSayDesde ) }
   ::oGrupoFamilia:Cargo:HelpHasta    := {|| BrwFamilia( ::oHasta, ::oSayHasta ) }
   ::oGrupoFamilia:Cargo:TextDesde    := {|| oRetFld( ::oGrupoFamilia:Cargo:Desde, ::oDbfFam, "cNomFam", "cCodFam" ) }
   ::oGrupoFamilia:Cargo:TextHasta    := {|| oRetFld( ::oGrupoFamilia:Cargo:Hasta, ::oDbfFam, "cNomFam", "cCodFam" ) }
   ::oGrupoFamilia:Cargo:ValidDesde   := {|oGet| if( cFamilia( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfFam:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFamilia:Cargo:ValidHasta   := {|oGet| if( cFamilia( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfFam:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFamilia:Cargo:lImprimir    := lImp
   ::oGrupoFamilia:Cargo:cBitmap      := "Cubes_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoFamilia:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFamilia )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoFamilia:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoFamilia:Cargo:Imagen := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFamilia:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFamilia )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFamilia )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfFam )
         ::oDbfFam:End()
      end

      lOpen                            := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoGFamilia( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oGruFam            := TGrpFam():Create( cPatArt(), "GRPFAM" )
   ::oGruFam:OpenFiles()

   ::oGrupoGFamilia                  := TRGroup():New( {|| ::oDbf:cCodGFam }, {|| "Grp. familia : " + AllTrim( ::oDbf:cCodGFam ) + " - " + AllTRim( ::oDbf:cNomGFam ) }, {|| "Total grp. familia : " + ::oDbf:cCodGFam }, {|| 3 }, ::lSalto )

   ::oGrupoGFamilia:Cargo            := TItemGroup()
   ::oGrupoGFamilia:Cargo:Nombre     := "Grp. familia"
   ::oGrupoGFamilia:Cargo:Expresion  := "cCodGFam"
   ::oGrupoGFamilia:Cargo:Todos      := .T.
   ::oGrupoGFamilia:Cargo:Desde      := Space( 3 )
   ::oGrupoGFamilia:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoGFamilia:Cargo:cPicDesde  := "@!"
   ::oGrupoGFamilia:Cargo:cPicHasta  := "@!"
   ::oGrupoGFamilia:Cargo:HelpDesde  := {|| ::oGruFam:Buscar( ::oDesde ) }
   ::oGrupoGFamilia:Cargo:HelpHasta  := {|| ::oGruFam:Buscar( ::oHasta ) }
   ::oGrupoGFamilia:Cargo:TextDesde  := {|| oRetFld( ::oGrupoGFamilia:Cargo:Desde, ::oGruFam:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGFamilia:Cargo:TextHasta  := {|| oRetFld( ::oGrupoGFamilia:Cargo:Hasta, ::oGruFam:oDbf, "cNomGrp", "cCodGrp" ) }
   ::oGrupoGFamilia:Cargo:ValidDesde := {|oGet| if( ::oGruFam:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomGrp", .T. ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGFamilia:Cargo:ValidHasta := {|oGet| if( ::oGruFam:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomGrp", .T. ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoGFamilia:Cargo:lImprimir  := lImp
   ::oGrupoGFamilia:Cargo:cBitmap    := "Folder_Cubes_Color_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "Folder_Cubes_Color_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoGFamilia )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "Folder_Cubes_Color_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoGFamilia:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoGFamilia:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoGFamilia )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoGFamilia )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oGruFam )
         ::oGruFam:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoTipoArticulo( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oTipArt            := TTipArt():New( cPatArt() )
   ::oTipArt:OpenFiles()

   ::oGrupoTArticulo                  := TRGroup():New( {|| ::oDbf:cCodTArt }, {|| "Tip. artículo : " + AllTrim( ::oDbf:cCodTArt ) + " - " + AllTRim( ::oDbf:cNomTArt ) }, {|| "Total tip. artículo : " + ::oDbf:cCodTArt }, {|| 3 }, ::lSalto )

   ::oGrupoTArticulo:Cargo            := TItemGroup()
   ::oGrupoTArticulo:Cargo:Nombre     := "Tipo artículo"
   ::oGrupoTArticulo:Cargo:Expresion  := "cCodTArt"
   ::oGrupoTArticulo:Cargo:Todos      := .T.
   ::oGrupoTArticulo:Cargo:Desde      := Space( 3 )
   ::oGrupoTArticulo:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoTArticulo:Cargo:cPicDesde  := "@!"
   ::oGrupoTArticulo:Cargo:cPicHasta  := "@!"
   ::oGrupoTArticulo:Cargo:HelpDesde  := {|| ::oTipArt:Buscar( ::oDesde ) }
   ::oGrupoTArticulo:Cargo:HelpHasta  := {|| ::oTipArt:Buscar( ::oHasta ) }
   ::oGrupoTArticulo:Cargo:TextDesde  := {|| oRetFld( ::oGrupoTArticulo:Cargo:Desde, ::oTipArt:oDbf, "cNomTip", "cCodTip" ) }
   ::oGrupoTArticulo:Cargo:TextHasta  := {|| oRetFld( ::oGrupoTArticulo:Cargo:Hasta, ::oTipArt:oDbf, "cNomTip", "cCodTip" ) }
   ::oGrupoTArticulo:Cargo:ValidDesde := {|oGet| if( ::oTipArt:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTArticulo:Cargo:ValidHasta := {|oGet| if( ::oTipArt:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTArticulo:Cargo:lImprimir  := lImp
   ::oGrupoTArticulo:Cargo:cBitmap    := "Cubes_Blue_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "Cubes_Blue_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoTArticulo )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "Cubes_Blue_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoTArticulo:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTArticulo:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTArticulo )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTArticulo )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oTipArt )
         ::oTipArt:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoFabricante( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oDbfFab            := TFabricantes():New( cPatEmp() )
   ::oDbfFab:OpenFiles()

   ::oGrupoFabricante                  := TRGroup():New( {|| ::oDbf:cCodFab }, {|| "Fabricante : " + AllTrim( ::oDbf:cCodFab ) + " - " + AllTRim( ::oDbf:cNomFab ) }, {|| "Total fabricante : " + ::oDbf:cCodFab }, {|| 3 }, ::lSalto )

   ::oGrupoFabricante:Cargo            := TItemGroup()
   ::oGrupoFabricante:Cargo:Nombre     := "Fabricante"
   ::oGrupoFabricante:Cargo:Expresion  := "cCodFab"
   ::oGrupoFabricante:Cargo:Todos      := .T.
   ::oGrupoFabricante:Cargo:Desde      := Space( 3 )
   ::oGrupoFabricante:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoFabricante:Cargo:cPicDesde  := "@!"
   ::oGrupoFabricante:Cargo:cPicHasta  := "@!"
   ::oGrupoFabricante:Cargo:HelpDesde  := {|| ::oDbfFab:Buscar( ::oDesde ) }
   ::oGrupoFabricante:Cargo:HelpHasta  := {|| ::oDbfFab:Buscar( ::oHasta ) }
   ::oGrupoFabricante:Cargo:TextDesde  := {|| oRetFld( ::oGrupoFabricante:Cargo:Desde, ::oDbfFab:oDbf, "cNomFab", "cCodFab" ) }
   ::oGrupoFabricante:Cargo:TextHasta  := {|| oRetFld( ::oGrupoFabricante:Cargo:Hasta, ::oDbfFab:oDbf, "cNomFab", "cCodFab" ) }
   ::oGrupoFabricante:Cargo:ValidDesde := {|oGet| if( ::oDbfFab:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomFab", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFabricante:Cargo:ValidHasta := {|oGet| if( ::oDbfFab:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomFab", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFabricante:Cargo:lImprimir  := lImp
   ::oGrupoFabricante:Cargo:cBitmap    := "Nut_and_bolt_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoFabricante:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFabricante )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoFabricante:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoFabricante:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFabricante:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFabricante )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFabricante )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfFab )
         ::oDbfFab:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoTipoExpediente( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oTipoExpediente    := TTipoExpediente():Create( cPatEmp() )
   ::oTipoExpediente:OpenFiles()

   ::oGrupoTipoExpediente                    := TRGroup():New( {|| ::oDbf:cCodTip }, {|| "Tipo expediente : " + AllTrim( ::oDbf:cCodTip ) + " - " + AllTRim( ::oDbf:cNomTip ) }, {|| "Total tipo expediente..." }, {|| 3 }, ::lSalto )

   ::oGrupoTipoExpediente:Cargo              := TItemGroup()
   ::oGrupoTipoExpediente:Cargo:Nombre       := "Tipo expediente"
   ::oGrupoTipoExpediente:Cargo:Expresion    := "cCodTip"
   ::oGrupoTipoExpediente:Cargo:Todos        := .T.
   ::oGrupoTipoExpediente:Cargo:Desde        := Space( 3 )
   ::oGrupoTipoExpediente:Cargo:Hasta        := Replicate( "Z", 3 )
   ::oGrupoTipoExpediente:Cargo:cPicDesde    := "@!"
   ::oGrupoTipoExpediente:Cargo:cPicHasta    := "@!"
   ::oGrupoTipoExpediente:Cargo:HelpDesde    := {|| ::oTipoExpediente:Buscar( ::oDesde ) }
   ::oGrupoTipoExpediente:Cargo:HelpHasta    := {|| ::oTipoExpediente:Buscar( ::oHasta ) }
   ::oGrupoTipoExpediente:Cargo:ValidDesde   := {|oGet| if( ::oTipoExpediente:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTipoExpediente:Cargo:ValidHasta   := {|oGet| if( ::oTipoExpediente:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomTip", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTipoExpediente:Cargo:lImprimir    := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Folders_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoTipoExpediente )

      ::oImageGroup:AddMasked( TBitmap():Define( "Folders_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoTipoExpediente:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTipoExpediente:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTipoExpediente )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTipoExpediente )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oTipoExpediente )
         ::oTipoExpediente:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoEntidad( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oEntidad           := TEntidades():Create( cPatEmp() )
   ::oEntidad:OpenFiles()

   ::oGrupoEntidad                    := TRGroup():New( {|| ::oDbf:cCodEnt }, {|| "Entidad : " + AllTrim( ::oDbf:cCodEnt ) + " - " + AllTrim( ::oDbf:cDesEnt ) }, {|| "Total entidad..." }, {|| 3 }, ::lSalto )

   ::oGrupoEntidad:Cargo              := TItemGroup()
   ::oGrupoEntidad:Cargo:Nombre       := "Entidad"
   ::oGrupoEntidad:Cargo:Expresion    := "cCodEnt"
   ::oGrupoEntidad:Cargo:Todos        := .T.
   ::oGrupoEntidad:Cargo:Desde        := Space( 3 )
   ::oGrupoEntidad:Cargo:Hasta        := Replicate( "Z", 3 )
   ::oGrupoEntidad:Cargo:cPicDesde    := "@!"
   ::oGrupoEntidad:Cargo:cPicHasta    := "@!"
   ::oGrupoEntidad:Cargo:HelpDesde    := {|| ::oEntidad:Buscar( ::oDesde ) }
   ::oGrupoEntidad:Cargo:HelpHasta    := {|| ::oEntidad:Buscar( ::oHasta ) }
   ::oGrupoEntidad:Cargo:ValidDesde   := {|oGet| if( ::oEntidad:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesEnt", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoEntidad:Cargo:ValidHasta   := {|oGet| if( ::oEntidad:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesEnt", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoEntidad:Cargo:lImprimir    := lImp

   ::oImageList:AddMasked( TBitmap():Define( "School_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoEntidad )

      ::oImageGroup:AddMasked( TBitmap():Define( "School_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoEntidad:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoEntidad:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoEntidad )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoEntidad )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oEntidad )
         ::oEntidad:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoColaborador( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oColaborador       := TColaboradores():Create( cPatEmp() )
   ::oColaborador:OpenFiles()

   ::oGrupoColaborador                    := TRGroup():New( {|| ::oDbf:cCodCol }, {|| "Colaborador : " + AllTrim( ::oDbf:cCodCol ) + " - " + AllTrim( ::oDbf:cDesCol ) }, {|| "Total Colaborador..." }, {|| 3 }, ::lSalto )

   ::oGrupoColaborador:Cargo              := TItemGroup()
   ::oGrupoColaborador:Cargo:Nombre       := "Colaborador"
   ::oGrupoColaborador:Cargo:Expresion    := "cCodCol"
   ::oGrupoColaborador:Cargo:Todos        := .T.
   ::oGrupoColaborador:Cargo:Desde        := Space( 3 )
   ::oGrupoColaborador:Cargo:Hasta        := Replicate( "Z", 3 )
   ::oGrupoColaborador:Cargo:cPicDesde    := "@!"
   ::oGrupoColaborador:Cargo:cPicHasta    := "@!"
   ::oGrupoColaborador:Cargo:HelpDesde    := {|| ::oColaborador:Buscar( ::oDesde ) }
   ::oGrupoColaborador:Cargo:HelpHasta    := {|| ::oColaborador:Buscar( ::oHasta ) }
   ::oGrupoColaborador:Cargo:ValidDesde   := {|oGet| if( ::oColaborador:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cDesCol", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoColaborador:Cargo:ValidHasta   := {|oGet| if( ::oColaborador:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cDesCol", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoColaborador:Cargo:lImprimir    := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Teacher_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoColaborador )

      ::oImageGroup:AddMasked( TBitmap():Define( "Teacher_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoColaborador:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoColaborador:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoColaborador )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoColaborador )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oColaborador )
         ::oColaborador:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoCategoria( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   IIF( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   if ::oDbfCat == nil .OR. !::oDbfCat:Used()
      ::oDbfCat := DbfServer( "CATEGORIAS.DBF", ):NewOpen( "CATEGORIAS.DBF",, ( cDriver() ),, ( cPatArt() ), .F., .T., .F., .F. ) ; ::oDbfCat:AddBag( "CATEGORIAS.CDX" ) ; ::oDbfCat:AddBag( ) ; ::oDbfCat:AutoIndex()
   end

   ::oGrupoCategoria                   := TRGroup():New( {|| ::oDbf:cCodCat }, {|| "Categoría : " + AllTrim( ::oDbf:cCodCat ) + " - " + AllTRim( ::oDbf:cNomCat ) }, {|| "Total categoria : " + ::oDbf:cCodCat }, {|| 3 }, ::lSalto )

   ::oGrupoCategoria:Cargo             := TItemGroup()
   ::oGrupoCategoria:Cargo:Nombre      := "Categorias"
   ::oGrupoCategoria:Cargo:Expresion   := "cCodCat"
   ::oGrupoCategoria:Cargo:Todos       := .T.
   ::oGrupoCategoria:Cargo:Desde       := Space( 3 )
   ::oGrupoCategoria:Cargo:Hasta       := Replicate( "Z", 3 )
   ::oGrupoCategoria:Cargo:cPicDesde   := "@!"
   ::oGrupoCategoria:Cargo:cPicHasta   := "@!"
   ::oGrupoCategoria:Cargo:HelpDesde   := {|| BrwCategoria( ::oDesde, ::oSayDesde ) }
   ::oGrupoCategoria:Cargo:HelpHasta   := {|| BrwCategoria( ::oHasta, ::oSayHasta ) }
   ::oGrupoCategoria:Cargo:TextDesde   := {|| oRetFld( ::oGrupoCategoria:Cargo:Desde, ::oDbfCat, "cNombre", "Codigo" ) }
   ::oGrupoCategoria:Cargo:TextHasta   := {|| oRetFld( ::oGrupoCategoria:Cargo:Hasta, ::oDbfCat, "cNombre", "Codigo" ) }
   ::oGrupoCategoria:Cargo:ValidDesde  := {|oGet| if( cCategoria( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfCat:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCategoria:Cargo:ValidHasta  := {|oGet| if( cCategoria( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfCat:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCategoria:Cargo:lImprimir   := lImp
   ::oGrupoCategoria:Cargo:cBitmap     := "Colors_16"





   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "Colors_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCategoria )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "Colors_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoCategoria:Cargo:Imagen   := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCategoria:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCategoria )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCategoria )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfCat )
         ::oDbfCat:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoRuta( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   IIF( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   BEGIN SEQUENCE

   if ::oDbfRut == nil .OR. !::oDbfRut:Used()
      ::oDbfRut := DbfServer( "RUTA.DBF", ):NewOpen( "RUTA.DBF",, ( cDriver() ),, ( cPatCli() ), .F., .T., .F., .F. ) ; ::oDbfRut:AddBag( "RUTA.CDX" ) ; ::oDbfRut:AddBag( ) ; ::oDbfRut:AutoIndex()
   end

   ::oGrupoRuta                  := TRGroup():New( {|| ::oDbf:cCodRut }, {|| "Ruta : " + AllTrim( ::oDbf:cCodRut ) + " - " + AllTRim( ::oDbf:cNomRut ) }, {|| "Total ruta..." }, {|| 3 }, ::lSalto )

   ::oGrupoRuta:Cargo            := TItemGroup()
   ::oGrupoRuta:Cargo:Nombre     := "Ruta"
   ::oGrupoRuta:Cargo:Expresion  := "cCodRut"
   ::oGrupoRuta:Cargo:Todos      := .T.
   ::oGrupoRuta:Cargo:Desde      := Space( 3 )
   ::oGrupoRuta:Cargo:Hasta      := Replicate( "Z", 3 )
   ::oGrupoRuta:Cargo:cPicDesde  := "@!"
   ::oGrupoRuta:Cargo:cPicHasta  := "@!"
   ::oGrupoRuta:Cargo:TextDesde  := {|| oRetFld( ::oGrupoRuta:Cargo:Desde, ::oDbfRut, "CDESRUT", "CCODRUT" ) }
   ::oGrupoRuta:Cargo:TextHasta  := {|| oRetFld( ::oGrupoRuta:Cargo:Hasta, ::oDbfRut, "CDESRUT", "CCODRUT" ) }
   ::oGrupoRuta:Cargo:HelpDesde  := {|| BrwRuta( ::oDesde, ::oDbfRut:cAlias, ::oSayDesde ) }
   ::oGrupoRuta:Cargo:HelpHasta  := {|| BrwRuta( ::oHasta, ::oDbfRut:cAlias, ::oSayHasta ) }
   ::oGrupoRuta:Cargo:ValidDesde := {|oGet| if( cRuta( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfRut:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoRuta:Cargo:ValidHasta := {|oGet| if( cRuta( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfRut:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoRuta:Cargo:lImprimir  := lImp

   ::oGrupoRuta:Cargo:cBitmap   := "Signpost_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "Signpost_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoRuta )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "Signpost_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoRuta:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoRuta:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoRuta )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoRuta )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfRut )
         ::oDbfRut:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoFacturasCompras( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   local cDesde
   local cHasta

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oFacPrvT == nil .OR. !::oFacCliT:Used()
      ::oFacPrvT := DbfServer( "FACPRVT.DBF", ):NewOpen( "FACPRVT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oFacPrvT:AddBag( "FACPRVT.CDX" ) ; ::oFacPrvT:AddBag( ) ; ::oFacPrvT:AutoIndex()
      ::oFacPrvT:OrdSetFocus( "nNumFac" )
   end





   ::oFacPrvT:GoBottom()
   cHasta               := ::oFacPrvT:cSerFac + Str( ::oFacPrvT:nNumFac ) + ::oFacPrvT:cSufFac





   ::oFacPrvT:GoTop()
   cDesde               := ::oFacPrvT:cSerFac + Str( ::oFacPrvT:nNumFac ) + ::oFacPrvT:cSufFac


   ::oGrupoFacturasCompras                  := TRGroup():New( {|| ::oDbf:cFactura }, {|| "Factura : " + AllTrim( ::oDbf:cFactura ) }, {|| "Total factura..." }, {|| 3 }, ::lSalto )

   ::oGrupoFacturasCompras:Cargo            := TItemGroup()
   ::oGrupoFacturasCompras:Cargo:Nombre     := "Factura"
   ::oGrupoFacturasCompras:Cargo:Expresion  := "cFactura"
   ::oGrupoFacturasCompras:Cargo:Todos      := .T.
   ::oGrupoFacturasCompras:Cargo:Desde      := cDesde
   ::oGrupoFacturasCompras:Cargo:Hasta      := cHasta
   ::oGrupoFacturasCompras:Cargo:cPicDesde  := "@R A/999999999/##"
   ::oGrupoFacturasCompras:Cargo:cPicHasta  := "@R A/999999999/##"
   ::oGrupoFacturasCompras:Cargo:HelpDesde  := {|| BrowseInformesFacPrv( ::oDesde, ::oSayDesde ) }
   ::oGrupoFacturasCompras:Cargo:HelpHasta  := {|| BrowseInformesFacPrv( ::oHasta, ::oSayHasta ) }
   ::oGrupoFacturasCompras:Cargo:ValidDesde := {|oGet| if( lValidInformeFacPrv( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFacturasCompras:Cargo:ValidHasta := {|oGet| if( lValidInformeFacPrv( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFacturasCompras:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Document_businessman_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFacturasCompras )

      ::oImageGroup:AddMasked( TBitmap():Define( "Document_businessman_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoFacturas:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFacturasCompra:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFacturasCompras )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFacturasCompras )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oFacPrvT )
         ::oFacPrvT:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoFacturas( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   local cDesde
   local cHasta

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oFacCliT == nil .OR. !::oFacCliT:Used()
      ::oFacCliT := DbfServer( "FACCLIT.DBF", ):NewOpen( "FACCLIT.DBF",, ( cDriver() ),, ( cPatEmp() ), .F., .T., .F., .F. ) ; ::oFacCliT:AddBag( "FACCLIT.CDX" ) ; ::oFacCliT:AddBag( ) ; ::oFacCliT:AutoIndex()
      ::oFacCliT:OrdSetFocus( "nNumFac" )
   end





   ::oFacCliT:GoBottom()
   cHasta               := ::oFacCliT:cSerie + Str( ::oFacCliT:nNumFac ) + ::oFacCliT:cSufFac





   ::oFacCliT:GoTop()
   cDesde               := ::oFacCliT:cSerie + Str( ::oFacCliT:nNumFac ) + ::oFacCliT:cSufFac


   ::oGrupoFacturas                  := TRGroup():New( {|| ::oDbf:cFactura }, {|| "Factura : " + AllTrim( ::oDbf:cFactura ) }, {|| "Total factura..." }, {|| 3 }, ::lSalto )

   ::oGrupoFacturas:Cargo            := TItemGroup()
   ::oGrupoFacturas:Cargo:Nombre     := "Factura"
   ::oGrupoFacturas:Cargo:Expresion  := "cFactura"
   ::oGrupoFacturas:Cargo:Todos      := .T.
   ::oGrupoFacturas:Cargo:Desde      := cDesde
   ::oGrupoFacturas:Cargo:Hasta      := cHasta
   ::oGrupoFacturas:Cargo:cPicDesde  := "@R A/999999999/##"
   ::oGrupoFacturas:Cargo:cPicHasta  := "@R A/999999999/##"
   ::oGrupoFacturas:Cargo:HelpDesde  := {|| BrowseInformesFacCli( ::oDesde, ::oSayDesde ) }
   ::oGrupoFacturas:Cargo:HelpHasta  := {|| BrowseInformesFacCli( ::oHasta, ::oSayHasta ) }
   ::oGrupoFacturas:Cargo:ValidDesde := {|oGet| if( lValidInformeFacCli( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFacturas:Cargo:ValidHasta := {|oGet| if( lValidInformeFacCli( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoFacturas:Cargo:lImprimir  := lImp

   ::oImageList:AddMasked( TBitmap():Define( "Document_user1_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoFacturas )

      ::oImageGroup:AddMasked( TBitmap():Define( "Document_user1_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )

      ::oGrupoFacturas:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) -1

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoFacturas:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoFacturas )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoFacturas )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oFacCliT )
         ::oFacCliT:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoTemporada( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfTmp == nil .OR. !::oDbfTmp:Used()
      ::oDbfTmp := DbfServer( "Temporadas.DBF", ):NewOpen( "Temporadas.DBF",, ( cDriver() ),, ( cPatArt() ), .F., .T., .F., .F. ) ; ::oDbfTmp:AddBag( "Temporadas.Cdx" ) ; ::oDbfTmp:AddBag( ) ; ::oDbfTmp:AutoIndex()
   end

   ::oGrupoTemporada                   := TRGroup():New( {|| ::oDbf:cCodTmp }, {|| "Temporada : " + AllTrim( ::oDbf:cCodTmp ) + " - " + AllTRim( ::oDbf:cNomTmp ) }, {|| "Total temporada..." }, {|| 3 }, ::lSalto )

   ::oGrupoTemporada:Cargo             := TItemGroup()
   ::oGrupoTemporada:Cargo:Nombre      := "Temporada"
   ::oGrupoTemporada:Cargo:Expresion   := "cCodTmp"
   ::oGrupoTemporada:Cargo:Todos       := .T.
   ::oGrupoTemporada:Cargo:Desde       := Space( 3 )
   ::oGrupoTemporada:Cargo:Hasta       := Replicate( "Z", 3 )
   ::oGrupoTemporada:Cargo:cPicDesde   := "@!"
   ::oGrupoTemporada:Cargo:cPicHasta   := "@!"
   ::oGrupoTemporada:Cargo:TextDesde   := {|| oRetFld( ::oGrupoTemporada:Cargo:Desde, ::oDbfTmp, "cNombre", "Codigo", .T. ) }
   ::oGrupoTemporada:Cargo:TextHasta   := {|| oRetFld( ::oGrupoTemporada:Cargo:Hasta, ::oDbfTmp, "cNombre", "Codigo", .T. ) }
   ::oGrupoTemporada:Cargo:HelpDesde   := {|| BrwTemporada( ::oDesde, ::oSayDesde, , .F. ) }
   ::oGrupoTemporada:Cargo:HelpHasta   := {|| BrwTemporada( ::oHasta, ::oSayHasta, , .F. ) }
   ::oGrupoTemporada:Cargo:ValidDesde  := {|oGet| if( cTemporada( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfTmp:cAlias, ::oSayDesde ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTemporada:Cargo:ValidHasta  := {|oGet| if( cTemporada( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfTmp:cAlias, ::oSayHasta ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoTemporada:Cargo:lImprimir   := lImp
   ::oGrupoTemporada:Cargo:cBitmap     := "Sun_and_cloud_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( "Sun_And_Cloud_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoTemporada )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( "Sun_And_Cloud_16" ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoTemporada:Cargo:Imagen    := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoTemporada:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoTemporada )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoTemporada )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfTmp )
         ::oDbfTmp:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoIva( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   if ::oDbfIva == nil .OR. !::oDbfIva:Used()
      ::oDbfIva := DbfServer( "TIva.Dbf", ):NewOpen( "TIva.Dbf",, ( cDriver() ),, ( cPatDat() ), .F., .T., .F., .F. ) ; ::oDbfIva:AddBag( "TIva.Cdx" ) ; ::oDbfIva:AddBag( ) ; ::oDbfIva:AutoIndex()
   end

   ::oGrupoIva                  := TRGroup():New( {|| ::oDbf:cCodIva }, {|| cImp() + " : " + AllTrim( ::oDbf:cCodIva ) }, {|| "Total " + cImp() + " : " + ::oDbf:cCodIva }, {|| 3 }, ::lSalto )

   ::oGrupoIva:Cargo            := TItemGroup()
   ::oGrupoIva:Cargo:Nombre     := cImp()
   ::oGrupoIva:Cargo:Expresion  := "cCodIva"
   ::oGrupoIva:Cargo:Todos      := .T.
   ::oGrupoIva:Cargo:Desde      := Space( 1 )
   ::oGrupoIva:Cargo:Hasta      := Replicate( "Z", 1 )
   ::oGrupoIva:Cargo:cPicDesde  := "@!"
   ::oGrupoIva:Cargo:cPicHasta  := "@!"
   ::oGrupoIva:Cargo:HelpDesde  := {|| BrwIva( ::oDesde, ::oDbfIva:cAlias ) }
   ::oGrupoIva:Cargo:HelpHasta  := {|| BrwIva( ::oHasta, ::oDbfIva:cAlias ) }
   ::oGrupoIva:Cargo:TextDesde  := {|| oRetFld( ::oGrupoIva:Cargo:Desde, ::oDbfIva, "DescIva", "Tipo" ) }
   ::oGrupoIva:Cargo:TextHasta  := {|| oRetFld( ::oGrupoIva:Cargo:Hasta, ::oDbfIva, "DescIva", "Tipo" ) }
   ::oGrupoIva:Cargo:ValidDesde := {|oGet| if( cTIva( if( !Empty( oGet ), oGet, ::oDesde ), ::oDbfIva:cAlias ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoIva:Cargo:ValidHasta := {|oGet| if( cTIva( if( !Empty( oGet ), oGet, ::oHasta ), ::oDbfIva:cAlias ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoIva:Cargo:lImprimir  := lImp
   ::oGrupoIva:Cargo:cBitmap    := "Moneybag_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoIva:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoIva )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoIva:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoIva:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoIva:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoIva )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoIva )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oDbfIva )
         ::oDbfIva:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoEntidadesBancarias( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock

   IIF( lImp == nil, lImp := .T., ) ;

   oBlock               := ErrorBlock( {| oError | ApoloBreak( oError ) } )
   BEGIN SEQUENCE

   ::oCuentasBancarias  := TCuentasBancarias():Create( cPatGrp() )
   ::oCuentasBancarias:OpenFiles()

   ::oGrupoCuentasBancarias                    := TRGroup():New( {|| ::oDbf:cCodBnc }, {|| "Cuenta bancaria : " + AllTrim( ::oDbf:cCodBnc ) + " - " + AllTrim( ::oDbf:cNomBnc ) }, {|| "Total cuenta bancaria..." }, {|| 3 }, ::lSalto )

   ::oGrupoCuentasBancarias:Cargo              := TItemGroup()
   ::oGrupoCuentasBancarias:Cargo:Nombre       := "Cta. bancaria"
   ::oGrupoCuentasBancarias:Cargo:Expresion    := "cCodBnc"
   ::oGrupoCuentasBancarias:Cargo:Todos        := .T.
   ::oGrupoCuentasBancarias:Cargo:Desde        := Space( 3 )
   ::oGrupoCuentasBancarias:Cargo:Hasta        := Replicate( "Z", 3 )
   ::oGrupoCuentasBancarias:Cargo:cPicDesde    := "@!"
   ::oGrupoCuentasBancarias:Cargo:cPicHasta    := "@!"
   ::oGrupoCuentasBancarias:Cargo:HelpDesde    := {|| ::oCuentasBancarias:Buscar( ::oDesde ) }
   ::oGrupoCuentasBancarias:Cargo:HelpHasta    := {|| ::oCuentasBancarias:Buscar( ::oHasta ) }
   ::oGrupoCuentasBancarias:Cargo:TextDesde    := {|| oRetFld( ::oGrupoCuentasBancarias:Cargo:Desde, ::oCuentasBancarias:oDbf, "cNomBnc", "cCodBnc" ) }
   ::oGrupoCuentasBancarias:Cargo:TextHasta    := {|| oRetFld( ::oGrupoCuentasBancarias:Cargo:Hasta, ::oCuentasBancarias:oDbf, "cNomBnc", "cCodBnc" ) }
   ::oGrupoCuentasBancarias:Cargo:ValidDesde   := {|oGet| if( ::oCuentasBancarias:Existe( if( !Empty( oGet ), oGet, ::oDesde ), ::oSayDesde, "cNomBnc", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCuentasBancarias:Cargo:ValidHasta   := {|oGet| if( ::oCuentasBancarias:Existe( if( !Empty( oGet ), oGet, ::oHasta ), ::oSayHasta, "cNomBnc", .T., .T., "0" ), ( ::ChangeValor(), .T. ), .F. ) }
   ::oGrupoCuentasBancarias:Cargo:lImprimir    := lImp
   ::oGrupoCuentasBancarias:Cargo:cBitmap      := "Office-building_address_book_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoCuentasBancarias:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoCuentasBancarias )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoCuentasBancarias:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoCuentasBancarias:Cargo:Imagen := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoCuentasBancarias:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoCuentasBancarias )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoCuentasBancarias )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      if !Empty( ::oCuentasBancarias )
         ::oCuentasBancarias:End()
      end

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_lGrupoSerie( lInitGroup, lImp) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local lOpen          := .T.
   local oError
   local oBlock         := ErrorBlock( {| oError | ApoloBreak( oError ) } )

   IIF( lImp == nil, lImp := .T., ) ;

   BEGIN SEQUENCE

   ::oGrupoSerie                  := TRGroup():New( {|| ::oDbf:cSerDoc }, {|| "Serie : "  }, {|| "Total serie : " + ::oDbf:cSerDoc }, {|| 3 }, ::lSalto )

   ::oGrupoSerie:Cargo            := TItemGroup()
   ::oGrupoSerie:Cargo:Nombre     := "Serie"
   ::oGrupoSerie:Cargo:Expresion  := "cSerDoc"
   ::oGrupoSerie:Cargo:Todos      := .T.
   ::oGrupoSerie:Cargo:Desde      := "A"
   ::oGrupoSerie:Cargo:Hasta      := "Z"
   ::oGrupoSerie:Cargo:cPicDesde  := "@!"
   ::oGrupoSerie:Cargo:cPicHasta  := "@!"
   ::oGrupoSerie:Cargo:HelpDesde  := {|| nil }
   ::oGrupoSerie:Cargo:HelpHasta  := {|| nil }
   ::oGrupoSerie:Cargo:TextDesde  := {|| "" }
   ::oGrupoSerie:Cargo:TextHasta  := {|| "" }
   ::oGrupoSerie:Cargo:ValidDesde := {| oGet | if( oGet:VarGet() >= "A" .AND. oGet:VarGet() <= "Z", .T., ( msgStop( "Las series desde deben de estar comprendidas entre la A y la Z" ), .F. ) ) }
   ::oGrupoSerie:Cargo:ValidHasta := {| oGet | if( oGet:VarGet() >= "A" .AND. oGet:VarGet() <= "Z", .T., ( msgStop( "Las series hasta deben de estar comprendidas entre la A y la Z" ), .F. ) ) }
   ::oGrupoSerie:Cargo:lImprimir  := lImp
   ::oGrupoSerie:Cargo:cBitmap    := "Sort_az_descending_alpha_16"

   if !Empty( ::oImageList )
      ::oImageList:AddMasked( TBitmap():Define( ::oGrupoSerie:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
   end

   if lInitGroup <> nil

      aAdd( ::aSelectionGroup, ::oGrupoSerie )

      if !Empty( ::oImageGroup )
         ::oImageGroup:AddMasked( TBitmap():Define( ::oGrupoSerie:Cargo:cBitmap ), ( 255 + ( 0 * 256 ) + ( 255 * 65536 ) ) )
         ::oGrupoSerie:Cargo:Imagen  := len( ::oImageGroup:aBitmaps ) - 1
      end

      if lInitGroup
         if !Empty( ::oColNombre )
            ::oColNombre:AddResource( ::oGrupoSerie:Cargo:cBitmap )
         end
         aAdd( ::aInitGroup, ::oGrupoSerie )
      end

   end

   aAdd( ::aSelectionRango, ::oGrupoSerie )

   RECOVER USING oError

      msgStop( ErrorMessage( oError ), "Imposible abrir todas las bases de datos" )

      lOpen          := .F.

   end

   ErrorBlock( oBlock )

RETURN ( lOpen )



UTILITY STATIC function TNewInfGen_oDefEstados( nIdEstadoUno, nIdEstadoDos, oDlg) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   IIF( nIdEstadoUno == nil, nIdEstadoUno := 218, ) ;
   IIF( nIdEstadoDos == nil, nIdEstadoDos := 219, ) ;
   IIF( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oEstadoUno := TComboBox():ReDefine( nIdEstadoUno, { | u | If( PCount()==0, ::cEstadoUno, ::cEstadoUno:= u ) }, ::aEstadoUno, oDlg,,,,,,, .F.,,,,,, )





   ::oEstadoDos := TComboBox():ReDefine( nIdEstadoDos, { | u | If( PCount()==0, ::cEstadoDos, ::cEstadoDos:= u ) }, ::aEstadoDos, oDlg,,,,,,, .F.,,,,,, )

Return( Self )



UTILITY STATIC function TNewInfGen_HideCondiciones() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if !::lDefEstadoUno .AND. ValType( ::oEstadoUno ) == "O"
      ::oEstadoUno:Hide()
   end

   if !::lDefEstadoDos .AND. ValType( ::oEstadoDos ) == "O"
      ::oEstadoDos:Hide()
   end

   if !::lDefCondiciones .AND. Valtype( ::oTreeCondiciones ) == "O"
      ::oTreeCondiciones:Hide()
   end

Return ( Self )



UTILITY STATIC function TNewInfGen_oDefDesde( nIdDesde, nIdSayDesde, oDlg) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   IIF( nIdDesde == nil, nIdDesde := 110, ) ;
   IIF( nIdSayDesde == nil, nIdSayDesde := 111, ) ;
   IIF( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oDesde := TGetHlp():ReDefine( ( nIdDesde ), { | u | If( PCount()==0, ::cDesde, ::cDesde:= u ) }, oDlg,,,,,,,,, .F., {||     ( !::lTodos )},, .F., .F.,,,,,, nil, "LUPA",, )




   ::oSayDesde := TGetHlp():ReDefine( ( nIdSayDesde ), { | u | If( PCount()==0, ::cSayDesde, ::cSayDesde:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

Return ( Self )



UTILITY STATIC function TNewInfGen_oDefHasta( nIdHasta, nIdSayHasta, oDlg) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   IIF( nIdHasta == nil, nIdHasta := 120, ) ;
   IIF( nIdSayHasta == nil, nIdSayHasta := 121, ) ;
   IIF( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oHasta := TGetHlp():ReDefine( ( nIdHasta ), { | u | If( PCount()==0, ::cHasta, ::cHasta:= u ) }, oDlg,,,,,,,,, .F., {||     ( !::lTodos )},, .F., .F.,,,,,, nil, "LUPA",, )




   ::oSayHasta := TGetHlp():ReDefine( ( nIdSayHasta ), { | u | If( PCount()==0, ::cSayHasta, ::cSayHasta:= u ) }, oDlg,,,,,,,,, .F., {||     .F.},, .F., .F.,,,,,, nil,,, )

Return ( Self )



UTILITY STATIC function TNewInfGen_oDefTodos( nIdTodos, oDlg) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   IIF( nIdTodos == nil, nIdTodos := 140, ) ;
   IIF( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;




   ::oTodos := TCheckBox():ReDefine( ( nIdTodos ), { | u | If( PCount()==0, ::lTodos, ::lTodos:= u ) }, oDlg,, {||( ::ChangeValor() )},,,,, .F.,, .F. )

return ( self )



UTILITY STATIC function TNewInfGen_ChangeRango() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local oItemSelect

   if !Empty( ::oTreeRango )

      oItemSelect          := ::oTreeRango:GetSelected()

      if oItemSelect <> nil .AND. oItemSelect:ClassName() == "TTVITEM"

         ::lTodos          := ( oItemSelect:Cargo:Cargo:Todos )
         ::cDesde          := ( oItemSelect:Cargo:Cargo:Desde )
         ::cHasta          := ( oItemSelect:Cargo:Cargo:Hasta )

         if !Empty( oItemSelect:Cargo:Cargo:bCondition )

            if !Eval( oItemSelect:Cargo:Cargo:bCondition )

               ::oTodos:Disable()
               ::oDesde:Disable()
               ::oHasta:Disable()

               ::oDesde:bHelp    := oItemSelect:Cargo:Cargo:HelpDesde
               ::oDesde:bValid   := oItemSelect:Cargo:Cargo:ValidDesde

               ::oHasta:bHelp    := oItemSelect:Cargo:Cargo:HelpHasta
               ::oHasta:bValid   := oItemSelect:Cargo:Cargo:ValidHasta

               ::oTodos:Click( ::lTodos )

               ::oDesde:cText( ::cDesde )
               ::oHasta:cText( ::cHasta )

               ::oDesde:lValid()
               ::oHasta:lValid()

            else

               ::oTodos:Enable()
               ::oDesde:Enable()
               ::oHasta:Enable()

               ::oDesde:bHelp    := oItemSelect:Cargo:Cargo:HelpDesde
               ::oDesde:bValid   := oItemSelect:Cargo:Cargo:ValidDesde

               ::oHasta:bHelp    := oItemSelect:Cargo:Cargo:HelpHasta
               ::oHasta:bValid   := oItemSelect:Cargo:Cargo:ValidHasta

               ::oTodos:Click( ::lTodos )
               ::oDesde:cText( ::cDesde )
               ::oHasta:cText( ::cHasta )

               ::oDesde:lValid()
               ::oHasta:lValid()

            end

         else

            ::oTodos:Enable()

            ::oDesde:bHelp             := oItemSelect:Cargo:Cargo:HelpDesde
            ::oDesde:bValid            := oItemSelect:Cargo:Cargo:ValidDesde
            ::oDesde:oGet:Picture      := oItemSelect:Cargo:Cargo:cPicDesde

            ::oHasta:bHelp             := oItemSelect:Cargo:Cargo:HelpHasta
            ::oHasta:bValid            := oItemSelect:Cargo:Cargo:ValidHasta
            ::oHasta:oGet:Picture      := oItemSelect:Cargo:Cargo:cPicHasta

            ::oTodos:Click( ::lTodos )

            ::oDesde:cText( ::cDesde )
            ::oHasta:cText( ::cHasta )

            ::oDesde:lValid()
            ::oHasta:lValid()

            ::oDesde:Refresh()
            ::oHasta:Refresh()

         end

      end

   end

Return( Self )



UTILITY STATIC function TNewInfGen_ChangeValor() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local oItemSelect

   if !Empty( ::oTreeRango )

    oItemSelect       := ::oTreeRango:GetSelected()

      if oItemSelect <> nil .AND. oItemSelect:ClassName() == "TTVITEM"

         oItemSelect:Cargo:Cargo:Todos  := ::lTodos
         oItemSelect:Cargo:Cargo:Desde  := ::oDesde:VarGet()
         oItemSelect:Cargo:Cargo:Hasta  := ::oHasta:VarGet()

      end

   end

Return ( self )



UTILITY STATIC function TNewInfGen_InitDialog() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   local n
   local nPos

   ::HideCondiciones()

   if !Empty( ::aSelectionRango )

      for n := 1 to len( ::aSelectionRango )
         with object ( ::oTreeRango:Add( ::aSelectionRango[ n ]:Cargo:Nombre, n - 1 ) )
            :Cargo := ::aSelectionRango[ n ]
         end
      next





      if len( ::oTreeRango:aItems ) > 0
         ::oTreeRango:Select( ::oTreeRango:aItems[ 1 ] )
         ::ChangeRango()
      end

   end

   ::oTreeRango:SetImagelist( ::oImageList )

   if !Empty( ::oTreeGroups )
      ::oTreeGroups:SetImagelist( ::oImageGroup )
   end

   if !Empty( ::oTreeSelectedGroups )
      ::oTreeSelectedGroups:SetImagelist( ::oImageGroup )
   end





   SysRefresh()

   if ::lDesglosar
      ::oDefDesglosar()
   end

   if ::lLinImporteCero
      ::oDefLinImporteCero()
   end

   if ::lDocImporteCero
      ::oDefDocImporteCero()
   end





   if !Empty( ::aSelectionGroup )
      for n := 1 to len( ::aSelectionGroup )
         with object ( ::oTreeGroups:Add( ::aSelectionGroup[ n ]:Cargo:Nombre, n - 1 ) )
            :Cargo := ::aSelectionGroup[ n ]
         end
      next
   end

   if ::oDbfGrp:Seek( cCurUsr() + ::cSubTitle )

      while Rtrim( cCurUsr() + ::cSubTitle ) == Rtrim( ::oDbfGrp:cCodUse + ::oDbfGrp:cNomInf ) .AND. !::oDbfGrp:eof()

         nPos     := aScan( ::aSelectionGroup, {|o| Rtrim( o:Cargo:Nombre ) == Rtrim( ::oDbfGrp:cNomGrp ) } )
         if nPos  <> 0
            aAdd( ::aSelectedGroup, ::aSelectionGroup[ nPos ] )
         end

         ::oDbfGrp:Skip()

      end

   else

      if !Empty( ::aInitGroup )
         aEval( ::aInitGroup, {| oGroup | aAdd( ::aSelectedGroup, oGroup ) } )
      end

   end

   ::ReLoadGroup()

RETURN ( Self )



UTILITY STATIC function TNewInfGen_oDefDesglosar() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oDesglosar      := ::oTreeCondiciones:Add( "Desglosar por propiedades y lotes", 0 )

   TvSetCheckState( ::oTreeCondiciones:hWnd, ::oDesglosar:hItem, .F. )

RETURN ( Self )



UTILITY STATIC function TNewInfGen_oDefLinImporteCero() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oLinImporteCero    := ::oTreeCondiciones:Add( "Excluir líneas con importe 0", 0 )

   TvSetCheckState( ::oTreeCondiciones:hWnd, ::oLinImporteCero:hItem, .T. )

RETURN ( Self )



UTILITY STATIC function TNewInfGen_oDefDocImporteCero() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oDocImporteCero    := ::oTreeCondiciones:Add( "Excluir documentos con importe 0", 0 )

   TvSetCheckState( ::oTreeCondiciones:hWnd, ::oDocImporteCero:hItem, .T. )

RETURN ( Self )



UTILITY STATIC function TNewInfGen_lIgualCliente() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

RETURN ( ::oGrupoCliente:Cargo:Desde == ::oGrupoCliente:Cargo:Hasta )



UTILITY STATIC function TNewInfGen_lPeriodoInforme( nId, oDlg) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   IIF( nId == nil, nId := 220, ) ;
   IIF( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;





   ::oPeriodo := TComboBox():ReDefine( nId, { | u | If( PCount()==0, ::cPeriodo, ::cPeriodo:= u ) }, ::aPeriodo, oDlg,,,,,,, .F.,,,,,, )

   ::oPeriodo:bChange   := {|| ::lRecargaFecha() }

RETURN ( .T. )



UTILITY STATIC function TNewInfGen_lRecargaFecha() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   do case
      case ::cPeriodo == "Hoy"

         ::oIniInf:cText( GetSysDate() )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Ayer"

         ::oIniInf:cText( GetSysDate() -1 )
         ::oFinInf:cText( GetSysDate() -1 )

      case ::cPeriodo == "Mes en curso"

         ::oIniInf:cText( CtoD( "01/" + Str( Month( GetSysDate() ) ) + "/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Mes anterior"

         ::oIniInf:cText( CtoD( "01/" + Str( Month( GetSysDate() ) - 1 ) + "/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( nLastDay( Month( GetSysDate() ) - 1 ) )

      case ::cPeriodo == "Primer trimestre"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/03/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Segundo trimestre"

         ::oIniInf:cText( CtoD( "01/04/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "30/06/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Tercer trimestre"

         ::oIniInf:cText( CtoD( "01/07/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "30/09/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Cuatro trimestre"

         ::oIniInf:cText( CtoD( "01/10/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Doce últimos meses"

         ::oIniInf:cText( CtoD( Str( Day( GetSysDate() ) ) + "/" + Str( Month( GetSysDate() ) ) + "/" + Str( Year( GetSysDate() ) -1 ) ) )
         ::oFinInf:cText( GetSysDate() )

      case ::cPeriodo == "Año en curso"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) ) ) )

      case ::cPeriodo == "Año anterior"

         ::oIniInf:cText( CtoD( "01/01/" + Str( Year( GetSysDate() ) - 1 ) ) )
         ::oFinInf:cText( CtoD( "31/12/" + Str( Year( GetSysDate() ) - 1 ) ) )

   end

RETURN ( .T. )



UTILITY STATIC function TNewInfGen_lCreaArrayPeriodos() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   aAdd( ::aPeriodo, "Hoy" )

   aAdd( ::aPeriodo, "Ayer" )

   aAdd( ::aPeriodo, "Mes en curso" )

   aAdd( ::aPeriodo, "Mes anterior" )

   do case
      case Month( GetSysDate() ) <= 3
         aAdd( ::aPeriodo, "Primer trimestre" )

      case Month( GetSysDate() ) > 3 .AND. Month( GetSysDate() ) <= 6
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )

      case Month( GetSysDate() ) > 6 .AND. Month( GetSysDate() ) <= 9
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )
         aAdd( ::aPeriodo, "Tercer trimestre" )

      case Month( GetSysDate() ) > 9 .AND. Month( GetSysDate() ) <= 12
         aAdd( ::aPeriodo, "Primer trimestre" )
         aAdd( ::aPeriodo, "Segundo trimestre" )
         aAdd( ::aPeriodo, "Tercer trimestre" )
         aAdd( ::aPeriodo, "Cuatro trimestre" )

   end

   aAdd( ::aPeriodo, "Doce últimos meses" )

   aAdd( ::aPeriodo, "Año en curso" )

   aAdd( ::aPeriodo, "Año anterior" )

RETURN ( .T. )



UTILITY STATIC function TNewInfGen_oDefHoraInicio( nId, oDlg) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   IIF( nId == nil, nId := 1111, ) ;
   IIF( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   if Empty( ::cHoraInicio )
      ::cHoraInicio  := uFieldEmpresa( "cIniJornada" )
   end









   ::oHoraInicio := TGetHlp():ReDefine( nId, { | u | If( PCount()==0, ::cHoraInicio, ::cHoraInicio:= u ) }, oDlg,, "@R 99:99", {||          ( ValidTime( ::oHoraInicio, .T. ) )},,,,,, .F.,,, .F., .T., {||          ( UpTime( ::oHoraInicio ) )}, {||        ( DwTime( ::oHoraInicio ) )},,,, nil,,, )

RETURN ( ::oHoraInicio )



UTILITY STATIC function TNewInfGen_oDefHoraFin( nId, oDlg) ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   IIF( nId == nil, nId := 1121, ) ;
   IIF( oDlg == nil, oDlg := ::oFld:aDialogs[1], ) ;

   if Empty( ::cHoraFin )
      ::cHoraFin  := "2359"
   end









   ::oHoraFin := TGetHlp():ReDefine( nId, { | u | If( PCount()==0, ::cHoraFin, ::cHoraFin:= u ) }, oDlg,, "@R 99:99", {||       ( ValidTime( ::oHoraFin, .T. ) )},,,,,, .F.,,, .F., .T., {||       ( UpTime( ::oHoraFin ) )}, {||     ( DwTime( ::oHoraFin ) )},,,, nil,,, )

RETURN ( ::oHoraFin )



UTILITY STATIC function TNewInfGen_AddVariable() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   public dFechaInicio                 := Dtoc( ::dIniInf )
   public dFechaFin                    := Dtoc( ::dFinInf )

   ::oFastReport:AddVariable(          "Informe",  "Desde fecha",                 "GetHbVar('dFechaInicio')" )
   ::oFastReport:AddVariable(          "Informe",  "Hasta fecha",                 "GetHbVar('dFechaFin')" )

   if !Empty( ::oGrupoFabricante )
      public cGrupoFabricanteDesde     := ::oGrupoFabricante:Cargo:Desde
      public cGrupoFabricanteHasta     := ::oGrupoFabricante:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de fabricante",  "GetHbVar('cGrupoFabricanteDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de fabricante",  "GetHbVar('cGrupoFabricanteHasta')" )
   end

   if !Empty( ::oGrupoArticulo )
      public cGrupoArticuloDesde       := ::oGrupoArticulo:Cargo:Desde
      public cGrupoArticuloHasta       := ::oGrupoArticulo:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de artículo",  "GetHbVar('cGrupoArticuloDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de artículo",  "GetHbVar('cGrupoArticuloHasta')" )
   end

   if !Empty( ::oGrupoCliente )
      public cGrupoClienteDesde        := ::oGrupoCliente:Cargo:Desde
      public cGrupoClienteHasta        := ::oGrupoCliente:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de cliente",  "GetHbVar('cGrupoClienteDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de cliente",  "GetHbVar('cGrupoClienteHasta')" )
   end

   if !Empty( ::oGrupoProveedor )
   end
   if !Empty( ::oGrupoOperacion )
   end
   if !Empty( ::oGrupoSeccion )
   end
   if !Empty( ::oGrupoAlmacen )
   end
   if !Empty( ::oGrupoMaquina )
   end
   if !Empty( ::oGrupoOperario )
   end
   if !Empty( ::oGrupoFpago )
   end
   if !Empty( ::oGrupoBanco )
   end
   if !Empty( ::oGrupoAgente )

      public cGrupoAgenteDesde         := ::oGrupoAgente:Cargo:Desde
      public cGrupoAgenteHasta         := ::oGrupoAgente:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de agente",  "GetHbVar('cGrupoAgenteDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de agente",  "GetHbVar('cGrupoAgenteHasta')" )

   end
   if !Empty( ::oGrupoUsuario )
   end
   if !Empty( ::oGrupoCaja )
   end
   if !Empty( ::oGrupoTransportista )
   end
   if !Empty( ::oGrupoGCliente )
   end
   if !Empty( ::oGrupoGProveedor )
   end
   if !Empty( ::oGrupoObra )
   end
   if !Empty( ::oGrupoFamilia )
   end
   if !Empty( ::oGrupoGFamilia )
   end
   if !Empty( ::oGrupoTArticulo )
   end
   if !Empty( ::oGrupoFabricante )
   end
   if !Empty( ::oGrupoTOperacion )
   end
   if !Empty( ::oGrupoCategoria )
   end
   if !Empty( ::oGrupoRuta )

      public cGrupoRutaDesde           := ::oGrupoRuta:Cargo:Desde
      public cGrupoRutaHasta           := ::oGrupoRuta:Cargo:Hasta

      ::oFastReport:AddVariable(       "Informe", "Desde código de ruta",  "GetHbVar('cGrupoRutaDesde')" )
      ::oFastReport:AddVariable(       "Informe", "Hasta código de ruta",  "GetHbVar('cGrupoRutaHasta')" )

   end
   if !Empty( ::oGrupoFacturas )
   end
   if !Empty( ::oGrupoFacturasCompras )
   end
   if !Empty( ::oGrupoTemporada )
   end
   if !Empty( ::oGrupoIVA )
   end
   if !Empty( ::oGrupoSerie )
   end

Return ( Self )



UTILITY STATIC function TNewInfGen_SaveReport() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if ::oDbfInf:Seek( cCurUsr() + Upper( ::cSubTitle ) )
      ::oDbfInf:Load()
      ::oDbfInf:cCodUse := cCurUsr()
      ::oDbfInf:cNomInf := ::cSubTitle
      ::oDbfInf:Save()
   else
      ::oDbfInf:Append()
      ::oDbfInf:cCodUse := cCurUsr()
      ::oDbfInf:cNomInf := ::cSubTitle
      ::oDbfInf:Save()
   end

RETURN ( ::oFastReport:SaveToBlob( ::oDbfInf:nArea, "mModInf" ) )



UTILITY STATIC function TNewInfGen_MoveReport() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   if ::oDbfInf:Seek( cCurUsr() + Upper( ::cSubTitle ) )

      ::oDbfInf:Load()

      ::oDbfInf:mOrgInf := ::oDbfInf:mModInf
      ::oDbfInf:Save()

      msgInfo( "El informe ha sido movido al original" )

   else

      msgStop( cCurUsr() + Upper( ::cSubTitle ), "No encontrado" )

   end

RETURN ( Self )



UTILITY STATIC function TNewInfGen_lHideFecha() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oPeriodo:Hide()

   ::oIniInf:Hide()
   ::oFinInf:Hide()

   if IsObject( ::oIniText )
      ::oIniText:Hide()
   end

   if IsObject( ::oFinText )
      ::oFinText:Hide()
   end

RETURN ( Self )



UTILITY STATIC function TNewInfGen_lShowFecha() ; local Self AS CLASS TNewInfGen := QSelf() AS CLASS TNewInfGen

   ::oPeriodo:Show()

   ::oIniInf:Show()
   ::oFinInf:Show()

   if IsObject( ::oIniText )
      ::oIniText:Show()
   end

   if IsObject( ::oFinText )
      ::oFinText:Show()
   end

RETURN ( Self )
